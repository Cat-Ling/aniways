"use strict";exports.id=34,exports.ids=[34],exports.modules={19034:(e,t,r)=>{var a=r(40102),n=r(43519),i=r(77791);async function s(e){return await n.getServerSession({get:t=>e.get(t)?.value})}async function o(e,t){let r=await s(e);if(null==r)return;let a=new i.MALClient({accessToken:r.accessToken});return{user:await a.getMyUserInfo(t),accessToken:r.accessToken}}Object.defineProperty(t,"Rr",{enumerable:!0,get:function(){return a.createMyAnimeListFetchHandler}}),t.Z1=s,t.PR=o},43519:(e,t,r)=>{e.exports=r(37231)},39405:(e,t)=>{t.DEFAULT_SESSION_DURATION_SECONDS=604800,t.MY_ANIME_LIST_API_URL="https://api.myanimelist.net/v2"},44431:(e,t,r)=>{var a=r(56866);class n{set(e,t,r){this.cookies.set(e,{value:t,options:r})}get(e){return this.cookies.get(e)?.value}delete(e,t){this.cookies.set(e,{value:"",options:{...t,maxAge:-1}})}get size(){return this.cookies.size}serialize(){let e=[];for(let[t,r]of this.cookies.entries()){let{value:n,options:i,fromHeader:s=!1}=r;if(!s){let r=a.serialize(t,n,i);e.push(r)}}return e}toJSON(){let e={};for(let[t,r]of this.cookies.entries())e[t]=r.value;return e}constructor(e){if(function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"cookies",new Map),e){let t=new Map;try{let r=a.parse(e);for(let e in r){let a=r[e];t.set(e,{value:a,fromHeader:!0})}this.cookies=t}catch(e){console.error(e)}}}}t.CookieJar=n},78649:(e,t,r)=>{async function a(e=43){let t=function(e=43){if(e<43||e>128)throw Error("code verifier length must be between 43 and 128 characters");let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r="";for(let a=0;a<e;a++){let e=Math.floor(Math.random()*t.length);r+=t.charAt(e)}return r}(e);return btoa(await ("undefined"!=typeof crypto&&crypto.subtle?n(t):i(t))).replace("+","-").replace("/","_").replace(/=+$/,"")}async function n(e){var t;let r=new TextEncoder().encode(e);return t=await crypto.subtle.digest("SHA-256",r),Array.from(new Uint8Array(t),e=>e.toString(16).padStart(2,"0")).join("")}async function i(e){let{SHA256:t}=await r.e(663).then(r.bind(r,73663));return Promise.resolve(t(e).toString())}t.createCodeChallenge=a},24280:(e,t)=>{t.getApiUrl=function(){return process.env.PUBLIC_MAL_API_URL?process.env.PUBLIC_MAL_API_URL:"/api/myanimelist"}},10847:(e,t)=>{function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a extends Error{toResponse(){let e=this.message,t=e?JSON.stringify({message:e}):null,r=this.headers||{};return t&&(r["Content-Type"]="application/json"),new Response(t,{status:this.status,headers:r})}constructor({status:e,headers:t,message:a,cause:n}){super(a,{cause:n}),r(this,"status",500),r(this,"headers",{}),this.status=e,this.headers=t||{}}}t.HttpError=a,t.error=function(e,t="Something went wrong"){if(e<400)throw Error(`'${e}' is not a valid http error status`);return new a({status:e,message:t})},t.redirect=function(e,t){return new a({status:e,headers:{Location:t}})}},37231:(e,t,r)=>{var a=r(24280),n=r(10847),i=r(44431),s=r(57485),o=r(39405);t.getApiUrl=a.getApiUrl,t.HttpError=n.HttpError,t.error=n.error,t.redirect=n.redirect,t.CookieJar=i.CookieJar,t.COOKIE_AUTH_ACCESS_TOKEN=s.COOKIE_AUTH_ACCESS_TOKEN,t.COOKIE_AUTH_CODE_CHALLENGE=s.COOKIE_AUTH_CODE_CHALLENGE,t.COOKIE_AUTH_CSRF=s.COOKIE_AUTH_CSRF,t.COOKIE_AUTH_SESSION=s.COOKIE_AUTH_SESSION,t.generateJwt=s.generateJwt,t.getRequiredServerSession=s.getRequiredServerSession,t.getServerSession=s.getServerSession,t.DEFAULT_SESSION_DURATION_SECONDS=o.DEFAULT_SESSION_DURATION_SECONDS,t.MY_ANIME_LIST_API_URL=o.MY_ANIME_LIST_API_URL},75403:(e,t)=>{t.invariant=function(e,t){if(!e)throw Error(t)}},89108:(e,t)=>{t.warnOnce=function(...e){let t=function(){let e=globalThis;return e.warnOnceMessages||(e.warnOnceMessages=new Set),e.warnOnceMessages}();t.has(e[0])||(t.add(e.join(" ")),console.warn(...e))}},57485:(e,t,r)=>{var a=r(99580),n=r(39405),i=r(10847);r(89108);let s=process.env.MAL_SECRET_KEY?process.env.MAL_SECRET_KEY:(console.error("❌ You must generate a secret key and set it to the environment variable 'MAL_SECRET_KEY'"),"nsuI9j2wnlH2dQ4I23g/0Ou/kCAwS8jhWh/lNcU7Yd1DS4wdNCQ5Nso+P/zukcIelBsZ9gomJhqichVYvKasaA=="),o="mal.session",d="mal.access_token",c="mal.audience",l="mal.issuer";function u(){if(s.length<=32)throw Error("Secret key must be at least 32 characters");return new TextEncoder().encode(s)}async function p(e,t){let r=new a.SignJWT({refreshToken:t,sub:String(e)}).setExpirationTime(Date.now()+n.DEFAULT_SESSION_DURATION_SECONDS).setAudience(c).setIssuer(l).setProtectedHeader({alg:"HS256"}),i=u();return await r.sign(i)}async function h(e){let t=u(),r=e.get(o),n=e.get(d);if(null==r||null==n)return null;try{let{payload:{refreshToken:e,sub:i}}=await a.jwtVerify(r,t,{audience:c,issuer:l}),s=Number(i);if("string"!=typeof e)return console.error(`invalid refresh token: '${e}'`),null;if(Number.isNaN(s))return console.error(`Invalid user id: '${s}'`),null;return{refreshToken:e,userId:s,accessToken:n}}catch{return null}}async function f(e,t="unable to get user session"){let r=await h(e);if(null==r)throw i.error(401,t);return r}t.COOKIE_AUTH_ACCESS_TOKEN=d,t.COOKIE_AUTH_CODE_CHALLENGE="mal.code_challenge",t.COOKIE_AUTH_CSRF="mal.csrf",t.COOKIE_AUTH_SESSION=o,t.generateJwt=p,t.getRequiredServerSession=f,t.getServerSession=h},81095:(e,t,r)=>{var a=r(77791),n=r(57485),i=r(88605),s=r(10847),o=r(44431),d=r(24280),c=r(39405);let l=["Authorization","X-MAL-CLIENT-ID","Content-Type"];async function u(e,t){let r;let a=new o.CookieJar(e.headers.get("cookie"));try{r=await p({request:e,cookies:a},t)}catch(e){if(e instanceof s.HttpError)r=e.toResponse();else throw e}for(let e of a.serialize())r.headers.append("Set-Cookie",e);return r}async function p(e,t){let{apiUrl:r,sessionDurationSeconds:o=c.DEFAULT_SESSION_DURATION_SECONDS,dev:d=!1}=t,l=new URL(e.request.url),u=function(e){let t=e.lastIndexOf("/");return t<0?e:e.slice(t)}(l.pathname),p=`${l.origin}${r}/auth`;switch(u){case"/sign-in":{let r=`${p}/callback`,{url:a,state:c,codeChallenge:l}=await i.Auth.getAuthenticationUrl({redirectTo:r});throw e.cookies.set(n.COOKIE_AUTH_CSRF,c,{path:"/",httpOnly:!0,sameSite:"lax",secure:!1===d,maxAge:o}),e.cookies.set(n.COOKIE_AUTH_CODE_CHALLENGE,l,{path:"/",httpOnly:!0,sameSite:"lax",secure:!1===d,maxAge:900}),t.callbacks?.onSignIn?.(e),s.redirect(307,a)}case"/sign-out":throw e.cookies.delete(n.COOKIE_AUTH_SESSION,{path:"/"}),e.cookies.delete(n.COOKIE_AUTH_CODE_CHALLENGE,{path:"/"}),e.cookies.delete(n.COOKIE_AUTH_ACCESS_TOKEN,{path:"/"}),e.cookies.delete(n.COOKIE_AUTH_CSRF,{path:"/"}),t.callbacks?.onSignOut?.(e),s.redirect(307,t.redirectAfterSignInUrl??"/");case"/callback":{let r=l.searchParams,a=r.get("code"),c=r.get("state"),u=e.cookies.get(n.COOKIE_AUTH_CODE_CHALLENGE);if(null==a)throw s.error(401,"No oauth2 code was received");if(null==u)throw s.error(401,"No oauth2 code challenge was received");let h=e.cookies.get(n.COOKIE_AUTH_CSRF);if(null==c||c!=h)throw s.error(401,"Invalid auth state");let f=await i.Auth.getToken({code:a,codeVerifier:u,redirectTo:`${p}/callback`}),y=i.Auth.getUserIdFromToken(f.access_token);if(null==y)throw s.error(401,"User id not found");let m=await n.generateJwt(y,f.refresh_token);e.cookies.set(n.COOKIE_AUTH_SESSION,m,{path:"/",httpOnly:!0,secure:!1===d,sameSite:"lax",maxAge:o});let{access_token:g,expires_in:v}=await i.Auth.refreshToken({refreshToken:f.refresh_token});throw e.cookies.set(n.COOKIE_AUTH_ACCESS_TOKEN,g,{path:"/",httpOnly:!0,secure:!1===d,sameSite:"lax",maxAge:v}),e.cookies.delete(n.COOKIE_AUTH_CODE_CHALLENGE),t.callbacks?.onCallback?.(e),s.redirect(307,t.redirectAfterSignOutUrl??"/")}case"/token":{let{accessToken:r,expiresAt:a}=await h(e);return t.callbacks?.onToken?.(e),y({accessToken:r,expiresAt:a})}case"/session":{let{accessToken:r,expiresAt:i}=await h(e),s="true"===l.searchParams.get("include_anime_statistics"),d=new a.MALClient({accessToken:r}),c=await d.getMyUserInfo({fields:s?["anime_statistics"]:[]});return e.cookies.set(n.COOKIE_AUTH_ACCESS_TOKEN,r,{path:"/",maxAge:o,httpOnly:!0,sameSite:"strict"}),t.callbacks?.onSession?.({user:c,accessToken:r,expiresAt:i},e),y({user:c,accessToken:r,expiresAt:i})}default:throw console.error(`❌ Invalid auth action: ${u}`),s.error(404)}}async function h(e){if(null==e.cookies.get(n.COOKIE_AUTH_SESSION))throw s.error(401);let t=await n.getServerSession(e.cookies);if(null==t)throw s.error(401);let{refreshToken:r,userId:a}=t,{access_token:o,expires_in:d}=await i.Auth.refreshToken({refreshToken:r});return{accessToken:o,expiresAt:new Date(1e3*d+Date.now()),userId:a}}async function f(e,t){let r={};for(let[e,a]of t.headers.entries())l.some(t=>t.toLowerCase()===e.toLowerCase())&&(r[e]=a);let a=new URL(t.url),n=a.pathname.slice(e.length),i=a.search,s=`${c.MY_ANIME_LIST_API_URL}${n}${i}`,o=await fetch(s,{method:t.method,body:t.body,headers:r,signal:t.signal,cache:t.cache,credentials:t.credentials,integrity:t.integrity,keepalive:t.keepalive,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy,duplex:"half"});return o.ok||console.error(`❌ ${t.method} (${o.status}) ${o.statusText}: ${s}`),o}function y(e){return new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}})}function m(e,t){let r=e.split("/").filter(e=>e.length>0),a=t.split("/").filter(e=>e.length>0);if(r.length<a.length)return!1;for(let e=0;e<a.length;e++)if(r[e]!==a[e])return!1;return!0}t.createMyAnimeListFetchHandler=function(e={}){let{sessionDurationSeconds:t=c.DEFAULT_SESSION_DURATION_SECONDS}=e;if(t<=0)throw Error(`Session duration must be greater than zero but was: ${t}`);let r=d.getApiUrl(),a=`${r}/auth`;if(r.endsWith("/"))throw Error("api url cannot end with '/'");return async n=>{let i=new URL(n.url).pathname;return m(i,r)?m(i,a)?u(n,{...e,apiUrl:r,sessionDurationSeconds:t}):e.callbacks?.onProxyRequest?e.callbacks.onProxyRequest(n,e=>f(r,e)):f(r,n):new Response(null,{status:404})}},t.handleAuthFetchRequest=u,t.proxyFetchRequestToMyAnimeList=f},68540:(e,t,r)=>{var a=r(88605),n=r(81095);Object.defineProperty(t,"Auth",{enumerable:!0,get:function(){return a.Auth}}),t.createMyAnimeListFetchHandler=n.createMyAnimeListFetchHandler,t.handleAuthFetchRequest=n.handleAuthFetchRequest,t.proxyFetchRequestToMyAnimeList=n.proxyFetchRequestToMyAnimeList},88605:(e,t,r)=>{var a=r(87245),n=r(99580),i=r(75403),s=r(78649);let o=process.env.MAL_CLIENT_ID,d=process.env.MAL_CLIENT_SECRET,c="https://myanimelist.net/v1/oauth2";t.Auth=void 0,function(e){async function t(e){i.invariant(o,"'MAL_CLIENT_ID' environment variable was not set");let{redirectTo:t}=e,r=crypto.randomUUID(),a=e.codeVerifier??await s.createCodeChallenge(),n=new URL(`${c}/authorize`);return n.searchParams.set("response_type","code"),n.searchParams.set("client_id",o),n.searchParams.set("code_challenge",a),n.searchParams.set("code_challenge_method","plain"),n.searchParams.set("state",r),t&&n.searchParams.set("redirect_uri",t),{url:n.toString(),codeChallenge:a,state:r}}async function r(e){i.invariant(o,"'MAL_CLIENT_ID' environment variable was not set"),i.invariant(d,"'MAL_CLIENT_SECRET' environment variable was not set");let{code:t,redirectTo:r}=e,n=new URL(`${c}/token`),s=new URLSearchParams({client_id:o,client_secret:d,grant_type:"authorization_code",code_verifier:e.codeVerifier,code:t});r&&s.set("redirect_uri",r);let l=await fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s});if(!l.ok){let e=await l.text();throw console.error(e),Error(e)}let u=a.z.object({token_type:a.z.literal("Bearer"),expires_in:a.z.number(),access_token:a.z.string(),refresh_token:a.z.string()}),p=await l.json();return u.parse(p)}async function l(e){let{refreshToken:t}=e,r=new URL(`${c}/token`),n=new URLSearchParams({grant_type:"refresh_token",refresh_token:t}),i=function(e){if("undefined"!=typeof Buffer)return Buffer.from(e).toString("base64");if("undefined"!=typeof btoa)return btoa(e);throw Error("Unable to convert string to base64, 'Buffer' and 'btoa' are not supported")}(`${o}:${d}`),s=await fetch(r,{method:"POST",headers:{Authorization:`Basic ${i}`,"Content-Type":"application/x-www-form-urlencoded"},body:n});if(!s.ok){let e=await s.text();throw console.error(`${s.status} ${s.statusText} - ${e}`),Error(e)}let l=a.z.object({token_type:a.z.literal("Bearer"),expires_in:a.z.number(),access_token:a.z.string(),refresh_token:a.z.string()}),u=await s.json();return l.parse(u)}e.getAuthenticationUrl=t,e.getToken=r,e.refreshToken=l,e.getUserIdFromToken=function(e){let t=n.decodeJwt(e);if(null==t.sub)return null;let r=Number(t.sub);return Number.isNaN(r)?null:r}}(t.Auth||(t.Auth={}))},40102:(e,t,r)=>{e.exports=r(68540)},77791:(e,t)=>{function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a extends Error{constructor(e,t,a){super(t,{cause:a}),r(this,"status",void 0),this.status=e}}class n{async request(e){let{resource:t,method:r,body:n,params:i,returnNullOn404:s=!1,headers:o={},signal:d}=e,{accessToken:c,clientId:l,fetch:u=globalThis.fetch,proxyUrl:p}=this.config,h=`${p??"https://api.myanimelist.net/v2"}${t}`;if(i&&Object.keys(i).length>0){let e=new URLSearchParams;for(let[t,r]of Object.entries(i))void 0!==r&&e.set(t,String(r));h+="?"+e.toString()}if(null==c&&null==l)throw Error("access token or client id are required");c&&(o.Authorization=`Bearer ${c}`),l&&null==c&&(o["X-MAL-CLIENT-ID"]=l);let f=await u(h,{method:r,headers:o,signal:d,body:n});if(!0===s&&404===f.status)return null;if(!f.ok){let e=await f.text();throw console.error(`❌ ${e}`),new a(f.status,e)}return await f.json()}async getAnimeList(e){let{fields:t=[],limit:r,offset:a,q:n,signal:i,...s}=e;return await this.request({method:"GET",resource:"/anime",signal:i,params:{q:n,limit:r,offset:a,fields:0===t.length?void 0:t.join(","),...s}})}async getAnimeDetails(e,t){let{fields:r=[],signal:a}=t||{};return await this.request({method:"GET",resource:`/anime/${e}`,returnNullOn404:!0,signal:a,params:{fields:0===r.length?void 0:r.join(",")}})}async getAnimeRanking(e){let{fields:t=[],signal:r,...a}=e;return await this.request({method:"GET",resource:"/anime/ranking",signal:r,params:{fields:0===t.length?void 0:t.join(","),...a}})}async getSeasonalAnime(e){let{fields:t=[],signal:r,year:a,season:n,...i}=e;return await this.request({method:"GET",resource:`/anime/season/${a}/${n}`,signal:r,params:{fields:0===t.length?void 0:t.join(","),...i}})}async getSuggestedAnime(e){let{fields:t=[],signal:r,...a}=e||{};return await this.request({method:"GET",resource:"/anime/suggestions",signal:r,params:{fields:0===t.length?void 0:t.join(","),...a}})}async updateMyAnimeListStatus(e,t){let{signal:r,...a}=t,n=new URLSearchParams;for(let[e,t]of Object.entries(a))void 0!==t&&n.set(e,String(t));return await this.request({method:"PATCH",resource:`/anime/${e}/my_list_status`,returnNullOn404:!0,body:n,signal:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}async deleteMyAnimeListStatus(e,t){let{signal:r}=t||{};return await this.request({method:"DELETE",resource:`/anime/${e}/my_list_status`,returnNullOn404:!0,signal:r})}async getUserAnimeList(e,t){let{fields:r=[],signal:a,...n}=t||{};return await this.request({method:"GET",resource:`/users/${e}/animelist`,signal:a,params:{fields:0===r.length?void 0:r.join(","),...n}})}async getMyUserInfo(e,t="@me"){let{fields:r=[],signal:a}=e||{};return await this.request({method:"GET",resource:`/users/${t}`,signal:a,params:{fields:r.length>0?r.join(","):void 0}})}constructor(e){if(r(this,"config",void 0),null==e.accessToken&&null==e.clientId)throw Error("access token or client id are required");this.config={...e}}}t.MALClient=n,t.MalHttpError=a},56866:(e,t)=>{/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.parse=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var r={},a=(t||{}).decode||n,i=0;i<e.length;){var s=e.indexOf("=",i);if(-1===s)break;var o=e.indexOf(";",i);if(-1===o)o=e.length;else if(o<s){i=e.lastIndexOf(";",s-1)+1;continue}var d=e.slice(i,s).trim();if(void 0===r[d]){var c=e.slice(s+1,o).trim();34===c.charCodeAt(0)&&(c=c.slice(1,-1)),r[d]=function(e,t){try{return t(e)}catch(t){return e}}(c,a)}i=o+1}return r},t.serialize=function(e,t,n){var s=n||{},o=s.encode||i;if("function"!=typeof o)throw TypeError("option encode is invalid");if(!a.test(e))throw TypeError("argument name is invalid");var d=o(t);if(d&&!a.test(d))throw TypeError("argument val is invalid");var c=e+"="+d;if(null!=s.maxAge){var l=s.maxAge-0;if(isNaN(l)||!isFinite(l))throw TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(l)}if(s.domain){if(!a.test(s.domain))throw TypeError("option domain is invalid");c+="; Domain="+s.domain}if(s.path){if(!a.test(s.path))throw TypeError("option path is invalid");c+="; Path="+s.path}if(s.expires){var u=s.expires;if("[object Date]"!==r.call(u)&&!(u instanceof Date)||isNaN(u.valueOf()))throw TypeError("option expires is invalid");c+="; Expires="+u.toUTCString()}if(s.httpOnly&&(c+="; HttpOnly"),s.secure&&(c+="; Secure"),s.priority)switch("string"==typeof s.priority?s.priority.toLowerCase():s.priority){case"low":c+="; Priority=Low";break;case"medium":c+="; Priority=Medium";break;case"high":c+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return c};var r=Object.prototype.toString,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function n(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}function i(e){return encodeURIComponent(e)}},99580:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cryptoRuntime=t.base64url=t.generateSecret=t.generateKeyPair=t.errors=t.decodeJwt=t.decodeProtectedHeader=t.importJWK=t.importX509=t.importPKCS8=t.importSPKI=t.exportJWK=t.exportSPKI=t.exportPKCS8=t.UnsecuredJWT=t.createRemoteJWKSet=t.createLocalJWKSet=t.EmbeddedJWK=t.calculateJwkThumbprintUri=t.calculateJwkThumbprint=t.EncryptJWT=t.SignJWT=t.GeneralSign=t.FlattenedSign=t.CompactSign=t.FlattenedEncrypt=t.CompactEncrypt=t.jwtDecrypt=t.jwtVerify=t.generalVerify=t.flattenedVerify=t.compactVerify=t.GeneralEncrypt=t.generalDecrypt=t.flattenedDecrypt=t.compactDecrypt=void 0;var a=r(59892);Object.defineProperty(t,"compactDecrypt",{enumerable:!0,get:function(){return a.compactDecrypt}});var n=r(36743);Object.defineProperty(t,"flattenedDecrypt",{enumerable:!0,get:function(){return n.flattenedDecrypt}});var i=r(80082);Object.defineProperty(t,"generalDecrypt",{enumerable:!0,get:function(){return i.generalDecrypt}});var s=r(49909);Object.defineProperty(t,"GeneralEncrypt",{enumerable:!0,get:function(){return s.GeneralEncrypt}});var o=r(99796);Object.defineProperty(t,"compactVerify",{enumerable:!0,get:function(){return o.compactVerify}});var d=r(78175);Object.defineProperty(t,"flattenedVerify",{enumerable:!0,get:function(){return d.flattenedVerify}});var c=r(85075);Object.defineProperty(t,"generalVerify",{enumerable:!0,get:function(){return c.generalVerify}});var l=r(58457);Object.defineProperty(t,"jwtVerify",{enumerable:!0,get:function(){return l.jwtVerify}});var u=r(88397);Object.defineProperty(t,"jwtDecrypt",{enumerable:!0,get:function(){return u.jwtDecrypt}});var p=r(44242);Object.defineProperty(t,"CompactEncrypt",{enumerable:!0,get:function(){return p.CompactEncrypt}});var h=r(92366);Object.defineProperty(t,"FlattenedEncrypt",{enumerable:!0,get:function(){return h.FlattenedEncrypt}});var f=r(30131);Object.defineProperty(t,"CompactSign",{enumerable:!0,get:function(){return f.CompactSign}});var y=r(5864);Object.defineProperty(t,"FlattenedSign",{enumerable:!0,get:function(){return y.FlattenedSign}});var m=r(53171);Object.defineProperty(t,"GeneralSign",{enumerable:!0,get:function(){return m.GeneralSign}});var g=r(90848);Object.defineProperty(t,"SignJWT",{enumerable:!0,get:function(){return g.SignJWT}});var v=r(90779);Object.defineProperty(t,"EncryptJWT",{enumerable:!0,get:function(){return v.EncryptJWT}});var _=r(94825);Object.defineProperty(t,"calculateJwkThumbprint",{enumerable:!0,get:function(){return _.calculateJwkThumbprint}}),Object.defineProperty(t,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return _.calculateJwkThumbprintUri}});var w=r(14249);Object.defineProperty(t,"EmbeddedJWK",{enumerable:!0,get:function(){return w.EmbeddedJWK}});var b=r(15324);Object.defineProperty(t,"createLocalJWKSet",{enumerable:!0,get:function(){return b.createLocalJWKSet}});var E=r(5648);Object.defineProperty(t,"createRemoteJWKSet",{enumerable:!0,get:function(){return E.createRemoteJWKSet}});var S=r(75697);Object.defineProperty(t,"UnsecuredJWT",{enumerable:!0,get:function(){return S.UnsecuredJWT}});var I=r(3460);Object.defineProperty(t,"exportPKCS8",{enumerable:!0,get:function(){return I.exportPKCS8}}),Object.defineProperty(t,"exportSPKI",{enumerable:!0,get:function(){return I.exportSPKI}}),Object.defineProperty(t,"exportJWK",{enumerable:!0,get:function(){return I.exportJWK}});var P=r(40661);Object.defineProperty(t,"importSPKI",{enumerable:!0,get:function(){return P.importSPKI}}),Object.defineProperty(t,"importPKCS8",{enumerable:!0,get:function(){return P.importPKCS8}}),Object.defineProperty(t,"importX509",{enumerable:!0,get:function(){return P.importX509}}),Object.defineProperty(t,"importJWK",{enumerable:!0,get:function(){return P.importJWK}});var T=r(33860);Object.defineProperty(t,"decodeProtectedHeader",{enumerable:!0,get:function(){return T.decodeProtectedHeader}});var C=r(90463);Object.defineProperty(t,"decodeJwt",{enumerable:!0,get:function(){return C.decodeJwt}}),t.errors=r(64478);var k=r(22421);Object.defineProperty(t,"generateKeyPair",{enumerable:!0,get:function(){return k.generateKeyPair}});var A=r(39745);Object.defineProperty(t,"generateSecret",{enumerable:!0,get:function(){return A.generateSecret}}),t.base64url=r(51320);var O=r(96770);Object.defineProperty(t,"cryptoRuntime",{enumerable:!0,get:function(){return O.default}})},59892:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compactDecrypt=void 0;let a=r(36743),n=r(64478),i=r(43866);async function s(e,t,r){if(e instanceof Uint8Array&&(e=i.decoder.decode(e)),"string"!=typeof e)throw new n.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:s,1:o,2:d,3:c,4:l,length:u}=e.split(".");if(5!==u)throw new n.JWEInvalid("Invalid Compact JWE");let p=await (0,a.flattenedDecrypt)({ciphertext:c,iv:d||void 0,protected:s||void 0,tag:l||void 0,encrypted_key:o||void 0},t,r),h={plaintext:p.plaintext,protectedHeader:p.protectedHeader};return"function"==typeof t?{...h,key:p.key}:h}t.compactDecrypt=s},44242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompactEncrypt=void 0;let a=r(92366);class n{constructor(e){this._flattened=new a.FlattenedEncrypt(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}t.CompactEncrypt=n},36743:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flattenedDecrypt=void 0;let a=r(24094),n=r(16808),i=r(58755),s=r(64478),o=r(76325),d=r(63143),c=r(22570),l=r(43866),u=r(63892),p=r(9573),h=r(34949);async function f(e,t,r){var f;let y,m,g,v,_,w,b;if(!(0,d.default)(e))throw new s.JWEInvalid("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new s.JWEInvalid("JOSE Header missing");if("string"!=typeof e.iv)throw new s.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new s.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new s.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new s.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new s.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new s.JWEInvalid("JWE AAD incorrect type");if(void 0!==e.header&&!(0,d.default)(e.header))throw new s.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!(0,d.default)(e.unprotected))throw new s.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=(0,a.decode)(e.protected);y=JSON.parse(l.decoder.decode(t))}catch{throw new s.JWEInvalid("JWE Protected Header is invalid")}if(!(0,o.default)(y,e.header,e.unprotected))throw new s.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let E={...y,...e.header,...e.unprotected};if((0,p.default)(s.JWEInvalid,new Map,null==r?void 0:r.crit,y,E),void 0!==E.zip){if(!y||!y.zip)throw new s.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==E.zip)throw new s.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:S,enc:I}=E;if("string"!=typeof S||!S)throw new s.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof I||!I)throw new s.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let P=r&&(0,h.default)("keyManagementAlgorithms",r.keyManagementAlgorithms),T=r&&(0,h.default)("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(P&&!P.has(S))throw new s.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(T&&!T.has(I))throw new s.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==e.encrypted_key)try{m=(0,a.decode)(e.encrypted_key)}catch{throw new s.JWEInvalid("Failed to base64url decode the encrypted_key")}let C=!1;"function"==typeof t&&(t=await t(y,e),C=!0);try{g=await (0,c.default)(S,t,m,E,r)}catch(e){if(e instanceof TypeError||e instanceof s.JWEInvalid||e instanceof s.JOSENotSupported)throw e;g=(0,u.default)(I)}try{v=(0,a.decode)(e.iv)}catch{throw new s.JWEInvalid("Failed to base64url decode the iv")}try{_=(0,a.decode)(e.tag)}catch{throw new s.JWEInvalid("Failed to base64url decode the tag")}let k=l.encoder.encode(null!==(f=e.protected)&&void 0!==f?f:"");w=void 0!==e.aad?(0,l.concat)(k,l.encoder.encode("."),l.encoder.encode(e.aad)):k;try{b=(0,a.decode)(e.ciphertext)}catch{throw new s.JWEInvalid("Failed to base64url decode the ciphertext")}let A=await (0,n.default)(I,g,b,v,_,w);"DEF"===E.zip&&(A=await ((null==r?void 0:r.inflateRaw)||i.inflate)(A));let O={plaintext:A};if(void 0!==e.protected&&(O.protectedHeader=y),void 0!==e.aad)try{O.additionalAuthenticatedData=(0,a.decode)(e.aad)}catch{throw new s.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(O.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(O.unprotectedHeader=e.header),C)?{...O,key:t}:O}t.flattenedDecrypt=f},92366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlattenedEncrypt=t.unprotected=void 0;let a=r(24094),n=r(64633),i=r(58755),s=r(93781),o=r(81700),d=r(64478),c=r(76325),l=r(43866),u=r(9573);t.unprotected=Symbol();class p{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,r){let p,h,f,y,m,g,v;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new d.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,c.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new d.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let _={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,u.default)(d.JWEInvalid,new Map,null==r?void 0:r.crit,this._protectedHeader,_),void 0!==_.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new d.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==_.zip)throw new d.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:w,enc:b}=_;if("string"!=typeof w||!w)throw new d.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof b||!b)throw new d.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===w){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===w&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let a;({cek:h,encryptedKey:p,parameters:a}=await (0,o.default)(w,b,e,this._cek,this._keyManagementParameters)),a&&(r&&t.unprotected in r?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...a}:this.setUnprotectedHeader(a):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...a}:this.setProtectedHeader(a))}if(this._iv||(this._iv=(0,s.default)(b)),y=this._protectedHeader?l.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):l.encoder.encode(""),this._aad?(m=(0,a.encode)(this._aad),f=(0,l.concat)(y,l.encoder.encode("."),l.encoder.encode(m))):f=y,"DEF"===_.zip){let e=await ((null==r?void 0:r.deflateRaw)||i.deflate)(this._plaintext);({ciphertext:g,tag:v}=await (0,n.default)(b,e,h,this._iv,f))}else({ciphertext:g,tag:v}=await (0,n.default)(b,this._plaintext,h,this._iv,f));let E={ciphertext:(0,a.encode)(g),iv:(0,a.encode)(this._iv),tag:(0,a.encode)(v)};return p&&(E.encrypted_key=(0,a.encode)(p)),m&&(E.aad=m),this._protectedHeader&&(E.protected=l.decoder.decode(y)),this._sharedUnprotectedHeader&&(E.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(E.header=this._unprotectedHeader),E}}t.FlattenedEncrypt=p},80082:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalDecrypt=void 0;let a=r(36743),n=r(64478),i=r(63143);async function s(e,t,r){if(!(0,i.default)(e))throw new n.JWEInvalid("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(i.default))throw new n.JWEInvalid("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new n.JWEInvalid("JWE Recipients has no members");for(let n of e.recipients)try{return await (0,a.flattenedDecrypt)({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch{}throw new n.JWEDecryptionFailed}t.generalDecrypt=s},49909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralEncrypt=void 0;let a=r(92366),n=r(64478),i=r(63892),s=r(76325),o=r(81700),d=r(24094),c=r(9573);class l{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}class u{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){let r=new l(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,l;let u;if(!this._recipients.length)throw new n.JWEInvalid("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){let[t]=this._recipients,r=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e}),n={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(n.aad=r.aad),r.protected&&(n.protected=r.protected),r.unprotected&&(n.unprotected=r.unprotected),r.encrypted_key&&(n.recipients[0].encrypted_key=r.encrypted_key),r.header&&(n.recipients[0].header=r.header),n}for(let e=0;e<this._recipients.length;e++){let t=this._recipients[e];if(!(0,s.default)(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new n.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:a}=r;if("string"!=typeof a||!a)throw new n.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===a||"ECDH-ES"===a)throw new n.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new n.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(u){if(u!==r.enc)throw new n.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else u=r.enc;if((0,c.default)(n.JWEInvalid,new Map,t.options.crit,this._protectedHeader,r),void 0!==r.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new n.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let p=(0,i.default)(u),h={ciphertext:"",iv:"",recipients:[],tag:""};for(let n=0;n<this._recipients.length;n++){let i=this._recipients[n],s={};h.recipients.push(s);let c=({...this._protectedHeader,...this._unprotectedHeader,...i.unprotectedHeader}).alg.startsWith("PBES2")?2048+n:void 0;if(0===n){let t=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(p).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(i.unprotectedHeader).setKeyManagementParameters({p2c:c}).encrypt(i.key,{...i.options,...e,[a.unprotected]:!0});h.ciphertext=t.ciphertext,h.iv=t.iv,h.tag=t.tag,t.aad&&(h.aad=t.aad),t.protected&&(h.protected=t.protected),t.unprotected&&(h.unprotected=t.unprotected),s.encrypted_key=t.encrypted_key,t.header&&(s.header=t.header);continue}let{encryptedKey:f,parameters:y}=await (0,o.default)((null===(t=i.unprotectedHeader)||void 0===t?void 0:t.alg)||(null===(r=this._protectedHeader)||void 0===r?void 0:r.alg)||(null===(l=this._unprotectedHeader)||void 0===l?void 0:l.alg),u,i.key,p,{p2c:c});s.encrypted_key=(0,d.encode)(f),(i.unprotectedHeader||y)&&(s.header={...i.unprotectedHeader,...y})}return h}}t.GeneralEncrypt=u},14249:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EmbeddedJWK=void 0;let a=r(40661),n=r(63143),i=r(64478);async function s(e,t){let r={...e,...null==t?void 0:t.header};if(!(0,n.default)(r.jwk))throw new i.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let s=await (0,a.importJWK)({...r.jwk,ext:!0},r.alg,!0);if(s instanceof Uint8Array||"public"!==s.type)throw new i.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return s}t.EmbeddedJWK=s},94825:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateJwkThumbprintUri=t.calculateJwkThumbprint=void 0;let a=r(98543),n=r(24094),i=r(64478),s=r(43866),o=r(63143),d=(e,t)=>{if("string"!=typeof e||!e)throw new i.JWKInvalid(`${t} missing or invalid`)};async function c(e,t){let r;if(!(0,o.default)(e))throw TypeError("JWK must be an object");if(null!=t||(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":d(e.crv,'"crv" (Curve) Parameter'),d(e.x,'"x" (X Coordinate) Parameter'),d(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":d(e.crv,'"crv" (Subtype of Key Pair) Parameter'),d(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":d(e.e,'"e" (Exponent) Parameter'),d(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":d(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new i.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let c=s.encoder.encode(JSON.stringify(r));return(0,n.encode)(await (0,a.default)(t,c))}async function l(e,t){null!=t||(t="sha256");let r=await c(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}t.calculateJwkThumbprint=c,t.calculateJwkThumbprintUri=l},15324:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalJWKSet=t.LocalJWKSet=t.isJWKSLike=void 0;let a=r(40661),n=r(64478),i=r(63143);function s(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(o)}function o(e){return(0,i.default)(e)}t.isJWKSLike=s;class d{constructor(e){if(this._cached=new WeakMap,!s(e))throw new n.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}(e)}async getKey(e,t){let{alg:r,kid:a}={...e,...null==t?void 0:t.header},i=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new n.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(r),s=this._jwks.keys.filter(e=>{let t=i===e.kty;if(t&&"string"==typeof a&&(t=a===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t}),{0:o,length:d}=s;if(0===d)throw new n.JWKSNoMatchingKey;if(1!==d){let e=new n.JWKSMultipleMatchingKeys,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of s)try{yield await c(t,e,r)}catch{continue}},e}return c(this._cached,o,r)}}async function c(e,t,r){let i=e.get(t)||e.set(t,{}).get(t);if(void 0===i[r]){let e=await (0,a.importJWK)({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new n.JWKSInvalid("JSON Web Key Set members must be public keys");i[r]=e}return i[r]}t.LocalJWKSet=d,t.createLocalJWKSet=function(e){let t=new d(e);return async function(e,r){return t.getKey(e,r)}}},5648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRemoteJWKSet=void 0;let a=r(38370),n=r(64478),i=r(15324);class s extends i.LocalJWKSet{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent,headers:null==t?void 0:t.headers},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==t?void 0:t.cacheMaxAge)?null==t?void 0:t.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof n.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,a.default)(this._url,this._timeoutDuration,this._options).then(e=>{if(!(0,i.isJWKSLike)(e))throw new n.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}t.createRemoteJWKSet=function(e,t){let r=new s(e,t);return async function(e,t){return r.getKey(e,t)}}},30131:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompactSign=void 0;let a=r(5864);class n{constructor(e){this._flattened=new a.FlattenedSign(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}t.CompactSign=n},99796:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compactVerify=void 0;let a=r(78175),n=r(64478),i=r(43866);async function s(e,t,r){if(e instanceof Uint8Array&&(e=i.decoder.decode(e)),"string"!=typeof e)throw new n.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:s,1:o,2:d,length:c}=e.split(".");if(3!==c)throw new n.JWSInvalid("Invalid Compact JWS");let l=await (0,a.flattenedVerify)({payload:o,protected:s,signature:d},t,r),u={payload:l.payload,protectedHeader:l.protectedHeader};return"function"==typeof t?{...u,key:l.key}:u}t.compactVerify=s},5864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlattenedSign=void 0;let a=r(24094),n=r(50222),i=r(76325),s=r(64478),o=r(43866),d=r(96014),c=r(9573);class l{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new s.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,i.default)(this._protectedHeader,this._unprotectedHeader))throw new s.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let l={...this._protectedHeader,...this._unprotectedHeader},u=(0,c.default)(s.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,l),p=!0;if(u.has("b64")&&"boolean"!=typeof(p=this._protectedHeader.b64))throw new s.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:h}=l;if("string"!=typeof h||!h)throw new s.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,d.default)(h,e,"sign");let f=this._payload;p&&(f=o.encoder.encode((0,a.encode)(f))),r=this._protectedHeader?o.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):o.encoder.encode("");let y=(0,o.concat)(r,o.encoder.encode("."),f),m=await (0,n.default)(h,e,y),g={signature:(0,a.encode)(m),payload:""};return p&&(g.payload=o.decoder.decode(f)),this._unprotectedHeader&&(g.header=this._unprotectedHeader),this._protectedHeader&&(g.protected=o.decoder.decode(r)),g}}t.FlattenedSign=l},78175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flattenedVerify=void 0;let a=r(24094),n=r(42052),i=r(64478),s=r(43866),o=r(76325),d=r(63143),c=r(96014),l=r(9573),u=r(34949);async function p(e,t,r){var p;let h,f;if(!(0,d.default)(e))throw new i.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new i.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new i.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new i.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new i.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,d.default)(e.header))throw new i.JWSInvalid("JWS Unprotected Header incorrect type");let y={};if(e.protected)try{let t=(0,a.decode)(e.protected);y=JSON.parse(s.decoder.decode(t))}catch{throw new i.JWSInvalid("JWS Protected Header is invalid")}if(!(0,o.default)(y,e.header))throw new i.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let m={...y,...e.header},g=(0,l.default)(i.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,y,m),v=!0;if(g.has("b64")&&"boolean"!=typeof(v=y.b64))throw new i.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:_}=m;if("string"!=typeof _||!_)throw new i.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let w=r&&(0,u.default)("algorithms",r.algorithms);if(w&&!w.has(_))throw new i.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(v){if("string"!=typeof e.payload)throw new i.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new i.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let b=!1;"function"==typeof t&&(t=await t(y,e),b=!0),(0,c.default)(_,t,"verify");let E=(0,s.concat)(s.encoder.encode(null!==(p=e.protected)&&void 0!==p?p:""),s.encoder.encode("."),"string"==typeof e.payload?s.encoder.encode(e.payload):e.payload);try{h=(0,a.decode)(e.signature)}catch{throw new i.JWSInvalid("Failed to base64url decode the signature")}if(!await (0,n.default)(_,t,h,E))throw new i.JWSSignatureVerificationFailed;if(v)try{f=(0,a.decode)(e.payload)}catch{throw new i.JWSInvalid("Failed to base64url decode the payload")}else f="string"==typeof e.payload?s.encoder.encode(e.payload):e.payload;let S={payload:f};return(void 0!==e.protected&&(S.protectedHeader=y),void 0!==e.header&&(S.unprotectedHeader=e.header),b)?{...S,key:t}:S}t.flattenedVerify=p},53171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralSign=void 0;let a=r(5864),n=r(64478);class i{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}class s{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){let r=new i(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new n.JWSInvalid("at least one signature must be added");let e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){let r=this._signatures[t],i=new a.FlattenedSign(this._payload);i.setProtectedHeader(r.protectedHeader),i.setUnprotectedHeader(r.unprotectedHeader);let{payload:s,...o}=await i.sign(r.key,r.options);if(0===t)e.payload=s;else if(e.payload!==s)throw new n.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");e.signatures.push(o)}return e}}t.GeneralSign=s},85075:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalVerify=void 0;let a=r(78175),n=r(64478),i=r(63143);async function s(e,t,r){if(!(0,i.default)(e))throw new n.JWSInvalid("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(i.default))throw new n.JWSInvalid("JWS Signatures missing or incorrect type");for(let n of e.signatures)try{return await (0,a.flattenedVerify)({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch{}throw new n.JWSSignatureVerificationFailed}t.generalVerify=s},88397:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwtDecrypt=void 0;let a=r(59892),n=r(71758),i=r(64478);async function s(e,t,r){let s=await (0,a.compactDecrypt)(e,t,r),o=(0,n.default)(s.protectedHeader,s.plaintext,r),{protectedHeader:d}=s;if(void 0!==d.iss&&d.iss!==o.iss)throw new i.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==d.sub&&d.sub!==o.sub)throw new i.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==d.aud&&JSON.stringify(d.aud)!==JSON.stringify(o.aud))throw new i.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let c={payload:o,protectedHeader:d};return"function"==typeof t?{...c,key:s.key}:c}t.jwtDecrypt=s},90779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptJWT=void 0;let a=r(44242),n=r(43866),i=r(42156);class s extends i.ProduceJWT{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new a.CompactEncrypt(n.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}t.EncryptJWT=s},42156:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProduceJWT=void 0;let a=r(12860),n=r(63143),i=r(32432);class s{constructor(e){if(!(0,n.default)(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:(0,a.default)(new Date)+(0,i.default)(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:(0,a.default)(new Date)+(0,i.default)(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:(0,a.default)(new Date)}:this._payload={...this._payload,iat:e},this}}t.ProduceJWT=s},90848:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SignJWT=void 0;let a=r(30131),n=r(64478),i=r(43866),s=r(42156);class o extends s.ProduceJWT{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;let s=new a.CompactSign(i.encoder.encode(JSON.stringify(this._payload)));if(s.setProtectedHeader(this._protectedHeader),Array.isArray(null===(r=this._protectedHeader)||void 0===r?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new n.JWTInvalid("JWTs MUST NOT use unencoded payload");return s.sign(e,t)}}t.SignJWT=o},75697:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnsecuredJWT=void 0;let a=r(24094),n=r(43866),i=r(64478),s=r(71758),o=r(42156);class d extends o.ProduceJWT{encode(){let e=a.encode(JSON.stringify({alg:"none"})),t=a.encode(JSON.stringify(this._payload));return`${e}.${t}.`}static decode(e,t){let r;if("string"!=typeof e)throw new i.JWTInvalid("Unsecured JWT must be a string");let{0:o,1:d,2:c,length:l}=e.split(".");if(3!==l||""!==c)throw new i.JWTInvalid("Invalid Unsecured JWT");try{if(r=JSON.parse(n.decoder.decode(a.decode(o))),"none"!==r.alg)throw Error()}catch{throw new i.JWTInvalid("Invalid Unsecured JWT")}return{payload:(0,s.default)(r,a.decode(d),t),header:r}}}t.UnsecuredJWT=d},58457:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwtVerify=void 0;let a=r(99796),n=r(71758),i=r(64478);async function s(e,t,r){var s;let o=await (0,a.compactVerify)(e,t,r);if((null===(s=o.protectedHeader.crit)||void 0===s?void 0:s.includes("b64"))&&!1===o.protectedHeader.b64)throw new i.JWTInvalid("JWTs MUST NOT use unencoded payload");let d={payload:(0,n.default)(o.protectedHeader,o.payload,r),protectedHeader:o.protectedHeader};return"function"==typeof t?{...d,key:o.key}:d}t.jwtVerify=s},3460:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportJWK=t.exportPKCS8=t.exportSPKI=void 0;let a=r(67801),n=r(67801),i=r(53783);async function s(e){return(0,a.toSPKI)(e)}async function o(e){return(0,n.toPKCS8)(e)}async function d(e){return(0,i.default)(e)}t.exportSPKI=s,t.exportPKCS8=o,t.exportJWK=d},22421:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=void 0;let a=r(58813);async function n(e,t){return(0,a.generateKeyPair)(e,t)}t.generateKeyPair=n},39745:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateSecret=void 0;let a=r(58813);async function n(e,t){return(0,a.generateSecret)(e,t)}t.generateSecret=n},40661:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importJWK=t.importPKCS8=t.importX509=t.importSPKI=void 0;let a=r(24094),n=r(67801),i=r(37260),s=r(64478),o=r(63143);async function d(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,n.fromSPKI)(e,t,r)}async function c(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,n.fromX509)(e,t,r)}async function l(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,n.fromPKCS8)(e,t,r)}async function u(e,t,r){var n;if(!(0,o.default)(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return(0,i.default)({...e,alg:t,ext:null!==(n=e.ext)&&void 0!==n&&n});return(0,a.decode)(e.k);case"RSA":if(void 0!==e.oth)throw new s.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,i.default)({...e,alg:t});default:throw new s.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}t.importSPKI=d,t.importX509=c,t.importPKCS8=l,t.importJWK=u},22673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=t.wrap=void 0;let a=r(64633),n=r(16808),i=r(93781),s=r(24094);async function o(e,t,r,n){let o=e.slice(0,7);n||(n=(0,i.default)(o));let{ciphertext:d,tag:c}=await (0,a.default)(o,r,t,n,new Uint8Array(0));return{encryptedKey:d,iv:(0,s.encode)(n),tag:(0,s.encode)(c)}}async function d(e,t,r,a,i){let s=e.slice(0,7);return(0,n.default)(s,t,r,a,i,new Uint8Array(0))}t.wrap=o,t.unwrap=d},43866:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.concatKdf=t.lengthAndInput=t.uint32be=t.uint64be=t.p2s=t.concat=t.decoder=t.encoder=void 0;let a=r(98543);function n(...e){let t=e.reduce((e,{length:t})=>e+t,0),r=new Uint8Array(t),a=0;return e.forEach(e=>{r.set(e,a),a+=e.length}),r}function i(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function s(e){let t=new Uint8Array(4);return i(t,e),t}async function o(e,t,r){let n=Math.ceil((t>>3)/32),i=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(s(t+1)),n.set(e,4),n.set(r,4+e.length),i.set(await (0,a.default)("sha256",n),32*t)}return i.slice(0,t>>3)}t.encoder=new TextEncoder,t.decoder=new TextDecoder,t.concat=n,t.p2s=function(e,r){return n(t.encoder.encode(e),new Uint8Array([0]),r)},t.uint64be=function(e){let t=new Uint8Array(8);return i(t,Math.floor(e/4294967296),0),i(t,e%4294967296,4),t},t.uint32be=s,t.lengthAndInput=function(e){return n(s(e.length),e)},t.concatKdf=o},63892:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bitLength=void 0;let a=r(64478),n=r(25233);function i(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}t.bitLength=i,t.default=e=>(0,n.default)(new Uint8Array(i(e)>>3))},17438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478),n=r(93781);t.default=(e,t)=>{if(t.length<<3!==(0,n.bitLength)(e))throw new a.JWEInvalid("Invalid Initialization Vector length")}},96014:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(30710),n=r(98400),i=(e,t)=>{if(!(t instanceof Uint8Array)){if(!(0,n.default)(t))throw TypeError((0,a.withAlg)(e,t,...n.types,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${n.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},s=(e,t,r)=>{if(!(0,n.default)(t))throw TypeError((0,a.withAlg)(e,t,...n.types));if("secret"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)};t.default=(e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?i(e,t):s(e,t,r)}},14863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478);t.default=function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new a.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}},38322:(e,t)=>{function r(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function a(e,t){return e.name===t}function n(e){return parseInt(e.name.slice(4),10)}function i(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkEncCryptoKey=t.checkSigCryptoKey=void 0,t.checkSigCryptoKey=function(e,t,...s){switch(t){case"HS256":case"HS384":case"HS512":{if(!a(e.algorithm,"HMAC"))throw r("HMAC");let i=parseInt(t.slice(2),10);if(n(e.algorithm.hash)!==i)throw r(`SHA-${i}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!a(e.algorithm,"RSASSA-PKCS1-v1_5"))throw r("RSASSA-PKCS1-v1_5");let i=parseInt(t.slice(2),10);if(n(e.algorithm.hash)!==i)throw r(`SHA-${i}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!a(e.algorithm,"RSA-PSS"))throw r("RSA-PSS");let i=parseInt(t.slice(2),10);if(n(e.algorithm.hash)!==i)throw r(`SHA-${i}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw r("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!a(e.algorithm,"ECDSA"))throw r("ECDSA");let n=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(t);if(e.algorithm.namedCurve!==n)throw r(n,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}i(e,s)},t.checkEncCryptoKey=function(e,t,...s){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!a(e.algorithm,"AES-GCM"))throw r("AES-GCM");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw r(n,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!a(e.algorithm,"AES-KW"))throw r("AES-KW");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw r(n,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw r("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!a(e.algorithm,"PBKDF2"))throw r("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!a(e.algorithm,"RSA-OAEP"))throw r("RSA-OAEP");let i=parseInt(t.slice(9),10)||1;if(n(e.algorithm.hash)!==i)throw r(`SHA-${i}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}i(e,s)}},22570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(25194),n=r(26005),i=r(57413),s=r(94231),o=r(24094),d=r(64478),c=r(63892),l=r(40661),u=r(96014),p=r(63143),h=r(22673);async function f(e,t,r,f,y){switch((0,u.default)(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new d.JWEInvalid("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new d.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i,s;if(!(0,p.default)(f.epk))throw new d.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!n.ecdhAllowed(t))throw new d.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let u=await (0,l.importJWK)(f.epk,e);if(void 0!==f.apu){if("string"!=typeof f.apu)throw new d.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=(0,o.decode)(f.apu)}catch{throw new d.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==f.apv){if("string"!=typeof f.apv)throw new d.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{s=(0,o.decode)(f.apv)}catch{throw new d.JWEInvalid("Failed to base64url decode the apv")}}let h=await n.deriveKey(u,t,"ECDH-ES"===e?f.enc:e,"ECDH-ES"===e?(0,c.bitLength)(f.enc):parseInt(e.slice(-5,-2),10),i,s);if("ECDH-ES"===e)return h;if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e.slice(-6),h,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");return(0,s.decrypt)(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let a;if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof f.p2c)throw new d.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let n=(null==y?void 0:y.maxPBES2Count)||1e4;if(f.p2c>n)throw new d.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof f.p2s)throw new d.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{a=(0,o.decode)(f.p2s)}catch{throw new d.JWEInvalid("Failed to base64url decode the p2s")}return(0,i.decrypt)(e,t,r,f.p2c,a)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let a,n;if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof f.iv)throw new d.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof f.tag)throw new d.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{a=(0,o.decode)(f.iv)}catch{throw new d.JWEInvalid("Failed to base64url decode the iv")}try{n=(0,o.decode)(f.tag)}catch{throw new d.JWEInvalid("Failed to base64url decode the tag")}return(0,h.unwrap)(e,t,r,a,n)}default:throw new d.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}t.default=f},81700:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(25194),n=r(26005),i=r(57413),s=r(94231),o=r(24094),d=r(63892),c=r(64478),l=r(3460),u=r(96014),p=r(22673);async function h(e,t,r,h,f={}){let y,m,g;switch((0,u.default)(e,r,"encrypt"),e){case"dir":g=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!n.ecdhAllowed(r))throw new c.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:i,apv:s}=f,{epk:u}=f;u||(u=(await n.generateEpk(r)).privateKey);let{x:p,y:v,crv:_,kty:w}=await (0,l.exportJWK)(u),b=await n.deriveKey(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?(0,d.bitLength)(t):parseInt(e.slice(-5,-2),10),i,s);if(m={epk:{x:p,crv:_,kty:w}},"EC"===w&&(m.epk.y=v),i&&(m.apu=(0,o.encode)(i)),s&&(m.apv=(0,o.encode)(s)),"ECDH-ES"===e){g=b;break}g=h||(0,d.default)(t);let E=e.slice(-6);y=await (0,a.wrap)(E,b,g);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":g=h||(0,d.default)(t),y=await (0,s.encrypt)(e,r,g);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{g=h||(0,d.default)(t);let{p2c:a,p2s:n}=f;({encryptedKey:y,...m}=await (0,i.encrypt)(e,r,g,a,n));break}case"A128KW":case"A192KW":case"A256KW":g=h||(0,d.default)(t),y=await (0,a.wrap)(e,r,g);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{g=h||(0,d.default)(t);let{iv:a}=f;({encryptedKey:y,...m}=await (0,p.wrap)(e,r,g,a));break}default:throw new c.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:g,encryptedKey:y,parameters:m}}t.default=h},12860:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>Math.floor(e.getTime()/1e3)},30710:(e,t)=>{function r(e,t,...a){if(a.length>2){let t=a.pop();e+=`one of type ${a.join(", ")}, or ${t}.`}else 2===a.length?e+=`one of type ${a[0]} or ${a[1]}.`:e+=`of type ${a[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}Object.defineProperty(t,"__esModule",{value:!0}),t.withAlg=void 0,t.default=(e,...t)=>r("Key must be ",e,...t),t.withAlg=function(e,t,...a){return r(`Key for the ${e} algorithm must be `,t,...a)}},76325:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0}},63143:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},93781:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bitLength=void 0;let a=r(64478),n=r(25233);function i(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}t.bitLength=i,t.default=e=>(0,n.default)(new Uint8Array(i(e)>>3))},71758:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478),n=r(43866),i=r(12860),s=r(32432),o=r(63143),d=e=>e.toLowerCase().replace(/^application\//,""),c=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));t.default=(e,t,r={})=>{let l,u;let{typ:p}=r;if(p&&("string"!=typeof e.typ||d(e.typ)!==d(p)))throw new a.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{l=JSON.parse(n.decoder.decode(t))}catch{}if(!(0,o.default)(l))throw new a.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:h=[],issuer:f,subject:y,audience:m,maxTokenAge:g}=r;for(let e of(void 0!==g&&h.push("iat"),void 0!==m&&h.push("aud"),void 0!==y&&h.push("sub"),void 0!==f&&h.push("iss"),new Set(h.reverse())))if(!(e in l))throw new a.JWTClaimValidationFailed(`missing required "${e}" claim`,e,"missing");if(f&&!(Array.isArray(f)?f:[f]).includes(l.iss))throw new a.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(y&&l.sub!==y)throw new a.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(m&&!c(l.aud,"string"==typeof m?[m]:m))throw new a.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":u=(0,s.default)(r.clockTolerance);break;case"number":u=r.clockTolerance;break;case"undefined":u=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:v}=r,_=(0,i.default)(v||new Date);if((void 0!==l.iat||g)&&"number"!=typeof l.iat)throw new a.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==l.nbf){if("number"!=typeof l.nbf)throw new a.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(l.nbf>_+u)throw new a.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==l.exp){if("number"!=typeof l.exp)throw new a.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(l.exp<=_-u)throw new a.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(g){let e=_-l.iat;if(e-u>("number"==typeof g?g:(0,s.default)(g)))throw new a.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-u)throw new a.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return l}},32432:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});let r=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;t.default=e=>{let t=r.exec(e);if(!t)throw TypeError("Invalid time period format");let a=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(a);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*a);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*a);case"day":case"days":case"d":return Math.round(86400*a);case"week":case"weeks":case"w":return Math.round(604800*a);default:return Math.round(31557600*a)}}},34949:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}},9573:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478);t.default=function(e,t,r,n,i){let s;if(void 0!==i.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let o of(s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!s.has(o))throw new a.JOSENotSupported(`Extension Header Parameter "${o}" is not recognized`);if(void 0===i[o])throw new e(`Extension Header Parameter "${o}" is missing`);if(s.get(o)&&void 0===n[o])throw new e(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(n.crit)}},25194:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=t.wrap=void 0;let a=r(14300),n=r(6113),i=r(64478),s=r(43866),o=r(33310),d=r(38322),c=r(84248),l=r(30710),u=r(66927),p=r(98400);function h(e,t){if(e.symmetricKeySize<<3!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function f(e,t,r){if((0,c.default)(e))return e;if(e instanceof Uint8Array)return(0,n.createSecretKey)(e);if((0,o.isCryptoKey)(e))return(0,d.checkEncCryptoKey)(e,t,r),n.KeyObject.from(e);throw TypeError((0,l.default)(e,...p.types,"Uint8Array"))}t.wrap=(e,t,r)=>{let o=parseInt(e.slice(1,4),10),d=`aes${o}-wrap`;if(!(0,u.default)(d))throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let c=f(t,e,"wrapKey");h(c,e);let l=(0,n.createCipheriv)(d,c,a.Buffer.alloc(8,166));return(0,s.concat)(l.update(r),l.final())},t.unwrap=(e,t,r)=>{let o=parseInt(e.slice(1,4),10),d=`aes${o}-wrap`;if(!(0,u.default)(d))throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let c=f(t,e,"unwrapKey");h(c,e);let l=(0,n.createDecipheriv)(d,c,a.Buffer.alloc(8,166));return(0,s.concat)(l.update(r),l.final())}},67801:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fromX509=t.fromSPKI=t.fromPKCS8=t.toPKCS8=t.toSPKI=void 0;let a=r(6113),n=r(14300),i=r(33310),s=r(84248),o=r(30710),d=r(98400),c=(e,t,r)=>{let n;if((0,i.isCryptoKey)(r)){if(!r.extractable)throw TypeError("CryptoKey is not extractable");n=a.KeyObject.from(r)}else if((0,s.default)(r))n=r;else throw TypeError((0,o.default)(r,...d.types));if(n.type!==e)throw TypeError(`key is not a ${e} key`);return n.export({format:"pem",type:t})};t.toSPKI=e=>c("public","spki",e),t.toPKCS8=e=>c("private","pkcs8",e),t.fromPKCS8=e=>(0,a.createPrivateKey)({key:n.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),t.fromSPKI=e=>(0,a.createPublicKey)({key:n.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),t.fromX509=e=>(0,a.createPublicKey)({key:e,type:"spki",format:"pem"})},35943:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){if(48!==e[0]||(this.buffer=e,this.offset=1,this.decodeLength()!==e.length-this.offset))throw TypeError()}decodeLength(){let e=this.buffer[this.offset++];if(128&e){let t=-129&e;e=0;for(let r=0;r<t;r++)e=e<<8|this.buffer[this.offset+r];this.offset+=t}return e}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let e=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,e--);let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}end(){if(this.offset!==this.buffer.length)throw TypeError()}}t.default=r},44061:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(14300),n=r(64478),i=a.Buffer.from([0]),s=a.Buffer.from([2]),o=a.Buffer.from([3]),d=a.Buffer.from([48]),c=a.Buffer.from([4]),l=e=>{if(e<128)return a.Buffer.from([e]);let t=a.Buffer.alloc(5);t.writeUInt32BE(e,1);let r=1;for(;0===t[r];)r++;return t[r-1]=128|5-r,t.slice(r-1)},u=new Map([["P-256",a.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",a.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",a.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",a.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",a.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",a.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",a.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",a.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",a.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);class p{constructor(){this.length=0,this.elements=[]}oidFor(e){let t=u.get(e);if(!t)throw new n.JOSENotSupported("Invalid or unsupported OID");this.elements.push(t),this.length+=t.length}zero(){this.elements.push(s,a.Buffer.from([1]),i),this.length+=3}one(){this.elements.push(s,a.Buffer.from([1]),a.Buffer.from([1])),this.length+=3}unsignedInteger(e){if(128&e[0]){let t=l(e.length+1);this.elements.push(s,t,i,e),this.length+=2+t.length+e.length}else{let t=0;for(;0===e[t]&&(128&e[t+1])==0;)t++;let r=l(e.length-t);this.elements.push(s,l(e.length-t),e.slice(t)),this.length+=1+r.length+e.length-t}}octStr(e){let t=l(e.length);this.elements.push(c,l(e.length),e),this.length+=1+t.length+e.length}bitStr(e){let t=l(e.length+1);this.elements.push(o,l(e.length+1),i,e),this.length+=1+t.length+e.length+1}add(e){this.elements.push(e),this.length+=e.length}end(e=d){let t=l(this.length);return a.Buffer.concat([e,t,...this.elements],1+t.length+this.length)}}t.default=p},24094:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=t.encodeBase64=t.decodeBase64=void 0;let a=r(14300),n=r(43866);a.Buffer.isEncoding("base64url")?t.encode=e=>a.Buffer.from(e).toString("base64url"):t.encode=e=>a.Buffer.from(e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),t.decodeBase64=e=>a.Buffer.from(e,"base64"),t.encodeBase64=e=>a.Buffer.from(e).toString("base64"),t.decode=e=>a.Buffer.from(function(e){let t=e;return t instanceof Uint8Array&&(t=n.decoder.decode(t)),t}(e),"base64")},46731:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(43866);t.default=function(e,t,r,i,s,o){let d=(0,n.concat)(e,t,r,(0,n.uint64be)(e.length<<3)),c=(0,a.createHmac)(`sha${i}`,s);return c.update(d),c.digest().slice(0,o>>3)}},58092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478),n=r(84248);t.default=(e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new a.JOSENotSupported(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if((0,n.default)(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},26251:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModulusLength=t.weakMap=void 0,t.weakMap=new WeakMap;let r=(e,t)=>{let a=e.readUInt8(1);if((128&a)==0)return 0===t?a:r(e.subarray(2+a),t-1);let n=127&a;a=0;for(let t=0;t<n;t++)a<<=8,a|=e.readUInt8(2+t);return 0===t?a:r(e.subarray(2+a),t-1)},a=(e,t)=>{let a=e.readUInt8(1);return(128&a)==0?r(e.subarray(2),t):r(e.subarray(2+(127&a)),t)},n=e=>{var r,n;if(t.weakMap.has(e))return t.weakMap.get(e);let i=null!==(n=null===(r=e.asymmetricKeyDetails)||void 0===r?void 0:r.modulusLength)&&void 0!==n?n:a(e.export({format:"der",type:"pkcs1"}),"private"===e.type?1:0)-1<<3;return t.weakMap.set(e,i),i};t.setModulusLength=(e,r)=>{t.weakMap.set(e,r)},t.default=(e,t)=>{if(2048>n(e))throw TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}},66927:(e,t,r)=>{let a;Object.defineProperty(t,"__esModule",{value:!0});let n=r(6113);t.default=e=>(a||(a=new Set((0,n.getCiphers)())),a.has(e))},16808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(17438),i=r(58092),s=r(43866),o=r(64478),d=r(97796),c=r(46731),l=r(33310),u=r(38322),p=r(84248),h=r(30710),f=r(66927),y=r(98400);t.default=(e,t,r,m,g,v)=>{let _;if((0,l.isCryptoKey)(t))(0,u.checkEncCryptoKey)(t,e,"decrypt"),_=a.KeyObject.from(t);else if(t instanceof Uint8Array||(0,p.default)(t))_=t;else throw TypeError((0,h.default)(t,...y.types,"Uint8Array"));switch((0,i.default)(e,_),(0,n.default)(e,m),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,n,i,l){let u,h;let y=parseInt(e.slice(1,4),10);(0,p.default)(t)&&(t=t.export());let m=t.subarray(y>>3),g=t.subarray(0,y>>3),v=parseInt(e.slice(-3),10),_=`aes-${y}-cbc`;if(!(0,f.default)(_))throw new o.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let w=(0,c.default)(l,n,r,v,g,y);try{u=(0,d.default)(i,w)}catch{}if(!u)throw new o.JWEDecryptionFailed;try{let e=(0,a.createDecipheriv)(_,m,n);h=(0,s.concat)(e.update(r),e.final())}catch{}if(!h)throw new o.JWEDecryptionFailed;return h}(e,_,r,m,g,v);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,n,i,s){let d=parseInt(e.slice(1,4),10),c=`aes-${d}-gcm`;if(!(0,f.default)(c))throw new o.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,a.createDecipheriv)(c,t,n,{authTagLength:16});e.setAuthTag(i),s.byteLength&&e.setAAD(s,{plaintextLength:r.length});let o=e.update(r);return e.final(),o}catch{throw new o.JWEDecryptionFailed}}(e,_,r,m,g,v);default:throw new o.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},98543:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113);t.default=(e,t)=>(0,a.createHash)(e).update(t).digest()},80051:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478);t.default=function(e){switch(e){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},26005:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ecdhAllowed=t.generateEpk=t.deriveKey=void 0;let a=r(6113),n=r(73837),i=r(14906),s=r(43866),o=r(64478),d=r(33310),c=r(38322),l=r(84248),u=r(30710),p=r(98400),h=(0,n.promisify)(a.generateKeyPair);async function f(e,t,r,n,i=new Uint8Array(0),o=new Uint8Array(0)){let h,f;if((0,d.isCryptoKey)(e))(0,c.checkEncCryptoKey)(e,"ECDH"),h=a.KeyObject.from(e);else if((0,l.default)(e))h=e;else throw TypeError((0,u.default)(e,...p.types));if((0,d.isCryptoKey)(t))(0,c.checkEncCryptoKey)(t,"ECDH","deriveBits"),f=a.KeyObject.from(t);else if((0,l.default)(t))f=t;else throw TypeError((0,u.default)(t,...p.types));let y=(0,s.concat)((0,s.lengthAndInput)(s.encoder.encode(r)),(0,s.lengthAndInput)(i),(0,s.lengthAndInput)(o),(0,s.uint32be)(n)),m=(0,a.diffieHellman)({privateKey:f,publicKey:h});return(0,s.concatKdf)(m,n,y)}async function y(e){let t;if((0,d.isCryptoKey)(e))t=a.KeyObject.from(e);else if((0,l.default)(e))t=e;else throw TypeError((0,u.default)(e,...p.types));switch(t.asymmetricKeyType){case"x25519":return h("x25519");case"x448":return h("x448");case"ec":return h("ec",{namedCurve:(0,i.default)(t)});default:throw new o.JOSENotSupported("Invalid or unsupported EPK")}}t.deriveKey=f,t.generateEpk=y,t.ecdhAllowed=e=>["P-256","P-384","P-521","X25519","X448"].includes((0,i.default)(e))},64633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(17438),i=r(58092),s=r(43866),o=r(46731),d=r(33310),c=r(38322),l=r(84248),u=r(30710),p=r(64478),h=r(66927),f=r(98400);t.default=(e,t,r,y,m)=>{let g;if((0,d.isCryptoKey)(r))(0,c.checkEncCryptoKey)(r,e,"encrypt"),g=a.KeyObject.from(r);else if(r instanceof Uint8Array||(0,l.default)(r))g=r;else throw TypeError((0,u.default)(r,...f.types,"Uint8Array"));switch((0,i.default)(e,g),(0,n.default)(e,y),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,n,i){let d=parseInt(e.slice(1,4),10);(0,l.default)(r)&&(r=r.export());let c=r.subarray(d>>3),u=r.subarray(0,d>>3),f=`aes-${d}-cbc`;if(!(0,h.default)(f))throw new p.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let y=(0,a.createCipheriv)(f,c,n),m=(0,s.concat)(y.update(t),y.final()),g=parseInt(e.slice(-3),10),v=(0,o.default)(i,n,m,g,u,d);return{ciphertext:m,tag:v}}(e,t,g,y,m);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,n,i){let s=parseInt(e.slice(1,4),10),o=`aes-${s}-gcm`;if(!(0,h.default)(o))throw new p.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let d=(0,a.createCipheriv)(o,r,n,{authTagLength:16});i.byteLength&&d.setAAD(i,{plaintextLength:t.length});let c=d.update(t);return d.final(),{ciphertext:c,tag:d.getAuthTag()}}(e,t,g,y,m);default:throw new p.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},38370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(13685),n=r(95687),i=r(82361),s=r(64478),o=r(43866),d=async(e,t,r)=>{let d;switch(e.protocol){case"https:":d=n.get;break;case"http:":d=a.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:c,headers:l}=r,u=d(e.href,{agent:c,timeout:t,headers:l}),[p]=await Promise.race([(0,i.once)(u,"response"),(0,i.once)(u,"timeout")]);if(!p)throw u.destroy(),new s.JWKSTimeout;if(200!==p.statusCode)throw new s.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let h=[];for await(let e of p)h.push(e);try{return JSON.parse(o.decoder.decode((0,o.concat)(...h)))}catch{throw new s.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};t.default=d},18407:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwkImport=t.jwkExport=t.rsaPssParams=t.oneShotCallback=void 0;let[r,a]=process.versions.node.split(".").map(e=>parseInt(e,10));t.oneShotCallback=r>=16||15===r&&a>=13,t.rsaPssParams=!("electron"in process.versions)&&(r>=17||16===r&&a>=9),t.jwkExport=r>=16||15===r&&a>=9,t.jwkImport=r>=16||15===r&&a>=12},58813:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=t.generateSecret=void 0;let a=r(6113),n=r(73837),i=r(25233),s=r(26251),o=r(64478),d=(0,n.promisify)(a.generateKeyPair);async function c(e,t){let r;switch(e){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new o.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,a.createSecretKey)((0,i.default)(new Uint8Array(r>>3)))}async function l(e,t){var r,a;switch(e){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let e=null!==(r=null==t?void 0:t.modulusLength)&&void 0!==r?r:2048;if("number"!=typeof e||e<2048)throw new o.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let a=await d("rsa",{modulusLength:e,publicExponent:65537});return(0,s.setModulusLength)(a.privateKey,e),(0,s.setModulusLength)(a.publicKey,e),a}case"ES256":return d("ec",{namedCurve:"P-256"});case"ES256K":return d("ec",{namedCurve:"secp256k1"});case"ES384":return d("ec",{namedCurve:"P-384"});case"ES512":return d("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==t?void 0:t.crv){case void 0:case"Ed25519":return d("ed25519");case"Ed448":return d("ed448");default:throw new o.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let n=null!==(a=null==t?void 0:t.crv)&&void 0!==a?a:"P-256";switch(n){case void 0:case"P-256":case"P-384":case"P-521":return d("ec",{namedCurve:n});case"X25519":return d("x25519");case"X448":return d("x448");default:throw new o.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new o.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}t.generateSecret=c,t.generateKeyPair=l},14906:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setCurve=t.weakMap=void 0;let a=r(14300),n=r(6113),i=r(64478),s=r(33310),o=r(84248),d=r(30710),c=r(98400),l=a.Buffer.from([42,134,72,206,61,3,1,7]),u=a.Buffer.from([43,129,4,0,34]),p=a.Buffer.from([43,129,4,0,35]),h=a.Buffer.from([43,129,4,0,10]);t.weakMap=new WeakMap;let f=e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new i.JOSENotSupported("Unsupported key curve for this operation")}},y=(e,r)=>{var a;let m;if((0,s.isCryptoKey)(e))m=n.KeyObject.from(e);else if((0,o.default)(e))m=e;else throw TypeError((0,d.default)(e,...c.types));if("secret"===m.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(m.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${m.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${m.asymmetricKeyType.slice(1)}`;case"ec":{if(t.weakMap.has(m))return t.weakMap.get(m);let e=null===(a=m.asymmetricKeyDetails)||void 0===a?void 0:a.namedCurve;if(e||"private"!==m.type){if(!e){let t=m.export({format:"der",type:"spki"}),r=t[1]<128?14:15,a=t[r],n=t.slice(r+1,r+1+a);if(n.equals(l))e="prime256v1";else if(n.equals(u))e="secp384r1";else if(n.equals(p))e="secp521r1";else if(n.equals(h))e="secp256k1";else throw new i.JOSENotSupported("Unsupported key curve for this operation")}}else e=y((0,n.createPublicKey)(m),!0);if(r)return e;let s=f(e);return t.weakMap.set(m,s),s}default:throw TypeError("Invalid asymmetric key type for this operation")}};t.setCurve=function(e,r){t.weakMap.set(e,r)},t.default=y},85575:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(33310),i=r(38322),s=r(30710),o=r(98400);t.default=function(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError((0,s.default)(t,...o.types));return(0,a.createSecretKey)(t)}if(t instanceof a.KeyObject)return t;if((0,n.isCryptoKey)(t))return(0,i.checkSigCryptoKey)(t,e,r),a.KeyObject.from(t);throw TypeError((0,s.default)(t,...o.types,"Uint8Array"))}},34640:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(64478);t.default=function(e){switch(e){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},98400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.types=void 0;let a=r(33310),n=r(84248);t.default=e=>(0,n.default)(e)||(0,a.isCryptoKey)(e);let i=["KeyObject"];t.types=i,(globalThis.CryptoKey||(null===a.default||void 0===a.default?void 0:a.default.CryptoKey))&&i.push("CryptoKey")},84248:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(73837);t.default=n.types.isKeyObject?e=>n.types.isKeyObject(e):e=>null!=e&&e instanceof a.KeyObject},37260:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(14300),n=r(6113),i=r(24094),s=r(64478),o=r(14906),d=r(26251),c=r(44061),l=r(18407);t.default=e=>{if(l.jwkImport&&"oct"!==e.kty)return e.d?(0,n.createPrivateKey)({format:"jwk",key:e}):(0,n.createPublicKey)({format:"jwk",key:e});switch(e.kty){case"oct":return(0,n.createSecretKey)((0,i.decode)(e.k));case"RSA":{let t=new c.default,r=void 0!==e.d,i=a.Buffer.from(e.n,"base64"),s=a.Buffer.from(e.e,"base64");r?(t.zero(),t.unsignedInteger(i),t.unsignedInteger(s),t.unsignedInteger(a.Buffer.from(e.d,"base64")),t.unsignedInteger(a.Buffer.from(e.p,"base64")),t.unsignedInteger(a.Buffer.from(e.q,"base64")),t.unsignedInteger(a.Buffer.from(e.dp,"base64")),t.unsignedInteger(a.Buffer.from(e.dq,"base64")),t.unsignedInteger(a.Buffer.from(e.qi,"base64"))):(t.unsignedInteger(i),t.unsignedInteger(s));let o={key:t.end(),format:"der",type:"pkcs1"},l=r?(0,n.createPrivateKey)(o):(0,n.createPublicKey)(o);return(0,d.setModulusLength)(l,i.length<<3),l}case"EC":{let t=new c.default,r=void 0!==e.d,i=a.Buffer.concat([a.Buffer.alloc(1,4),a.Buffer.from(e.x,"base64"),a.Buffer.from(e.y,"base64")]);if(r){t.zero();let r=new c.default;r.oidFor("ecPublicKey"),r.oidFor(e.crv),t.add(r.end());let s=new c.default;s.one(),s.octStr(a.Buffer.from(e.d,"base64"));let d=new c.default;d.bitStr(i);let l=d.end(a.Buffer.from([161]));s.add(l);let u=s.end(),p=new c.default;p.add(u);let h=p.end(a.Buffer.from([4]));t.add(h);let f=t.end(),y=(0,n.createPrivateKey)({key:f,format:"der",type:"pkcs8"});return(0,o.setCurve)(y,e.crv),y}let s=new c.default;s.oidFor("ecPublicKey"),s.oidFor(e.crv),t.add(s.end()),t.bitStr(i);let d=t.end(),l=(0,n.createPublicKey)({key:d,format:"der",type:"spki"});return(0,o.setCurve)(l,e.crv),l}case"OKP":{let t=new c.default;if(void 0!==e.d){t.zero();let r=new c.default;r.oidFor(e.crv),t.add(r.end());let i=new c.default;i.octStr(a.Buffer.from(e.d,"base64"));let s=i.end(a.Buffer.from([4]));t.add(s);let o=t.end();return(0,n.createPrivateKey)({key:o,format:"der",type:"pkcs8"})}let r=new c.default;r.oidFor(e.crv),t.add(r.end()),t.bitStr(a.Buffer.from(e.x,"base64"));let i=t.end();return(0,n.createPublicKey)({key:i,format:"der",type:"spki"})}default:throw new s.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},53783:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(24094),i=r(35943),s=r(64478),o=r(14906),d=r(33310),c=r(84248),l=r(30710),u=r(98400),p=r(18407),h=e=>{let t;if((0,d.isCryptoKey)(e)){if(!e.extractable)throw TypeError("CryptoKey is not extractable");t=a.KeyObject.from(e)}else if((0,c.default)(e))t=e;else if(e instanceof Uint8Array)return{kty:"oct",k:(0,n.encode)(e)};else throw TypeError((0,l.default)(e,...u.types,"Uint8Array"));if(p.jwkExport){if("secret"!==t.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(t.asymmetricKeyType))throw new s.JOSENotSupported("Unsupported key asymmetricKeyType");return t.export({format:"jwk"})}switch(t.type){case"secret":return{kty:"oct",k:(0,n.encode)(t.export())};case"private":case"public":switch(t.asymmetricKeyType){case"rsa":{let e;let r=t.export({format:"der",type:"pkcs1"}),a=new i.default(r);"private"===t.type&&a.unsignedInteger();let s=(0,n.encode)(a.unsignedInteger()),o=(0,n.encode)(a.unsignedInteger());return"private"===t.type&&(e={d:(0,n.encode)(a.unsignedInteger()),p:(0,n.encode)(a.unsignedInteger()),q:(0,n.encode)(a.unsignedInteger()),dp:(0,n.encode)(a.unsignedInteger()),dq:(0,n.encode)(a.unsignedInteger()),qi:(0,n.encode)(a.unsignedInteger())}),a.end(),{kty:"RSA",n:s,e:o,...e}}case"ec":{let e,r,i;let d=(0,o.default)(t);switch(d){case"secp256k1":e=64,r=33,i=-1;break;case"P-256":e=64,r=36,i=-1;break;case"P-384":e=96,r=35,i=-3;break;case"P-521":e=132,r=35,i=-3;break;default:throw new s.JOSENotSupported("Unsupported curve")}if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"EC",crv:d,x:(0,n.encode)(r.subarray(-e,-e/2)),y:(0,n.encode)(r.subarray(-e/2))}}let c=t.export({type:"pkcs8",format:"der"});return c.length<100&&(r+=i),{...h((0,a.createPublicKey)(t)),d:(0,n.encode)(c.subarray(r,r+e/2))}}case"ed25519":case"x25519":{let e=(0,o.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,n.encode)(r.subarray(-32))}}let r=t.export({type:"pkcs8",format:"der"});return{...h((0,a.createPublicKey)(t)),d:(0,n.encode)(r.subarray(-32))}}case"ed448":case"x448":{let e=(0,o.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,n.encode)(r.subarray("Ed448"===e?-57:-56))}}let r=t.export({type:"pkcs8",format:"der"});return{...h((0,a.createPublicKey)(t)),d:(0,n.encode)(r.subarray("Ed448"===e?-57:-56))}}default:throw new s.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new s.JOSENotSupported("Unsupported key type")}};t.default=h},25865:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(14906),i=r(64478),s=r(26251),o=r(18407),d={padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},c=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);t.default=function(e,t){switch(e){case"EdDSA":if(!["ed25519","ed448"].includes(t.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return t;case"RS256":case"RS384":case"RS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,s.default)(t,e),t;case o.rsaPssParams&&"PS256":case o.rsaPssParams&&"PS384":case o.rsaPssParams&&"PS512":if("rsa-pss"===t.asymmetricKeyType){let{hashAlgorithm:r,mgf1HashAlgorithm:a,saltLength:n}=t.asymmetricKeyDetails,i=parseInt(e.slice(-3),10);if(void 0!==r&&(r!==`sha${i}`||a!==r))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}`);if(void 0!==n&&n>i>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}`)}else if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,s.default)(t,e),{key:t,...d};case!o.rsaPssParams&&"PS256":case!o.rsaPssParams&&"PS384":case!o.rsaPssParams&&"PS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,s.default)(t,e),{key:t,...d};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let r=(0,n.default)(t),a=c.get(e);if(r!==a)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${a}, got ${r}`);return{dsaEncoding:"ieee-p1363",key:t}}default:throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},57413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;let a=r(73837),n=r(6113),i=r(25233),s=r(43866),o=r(24094),d=r(25194),c=r(14863),l=r(33310),u=r(38322),p=r(84248),h=r(30710),f=r(98400),y=(0,a.promisify)(n.pbkdf2);function m(e,t){if((0,p.default)(e))return e.export();if(e instanceof Uint8Array)return e;if((0,l.isCryptoKey)(e))return(0,u.checkEncCryptoKey)(e,t,"deriveBits","deriveKey"),n.KeyObject.from(e).export();throw TypeError((0,h.default)(e,...f.types,"Uint8Array"))}let g=async(e,t,r,a=2048,n=(0,i.default)(new Uint8Array(16)))=>{(0,c.default)(n);let l=(0,s.p2s)(e,n),u=parseInt(e.slice(13,16),10)>>3,p=m(t,e),h=await y(p,l,a,u,`sha${e.slice(8,11)}`);return{encryptedKey:await (0,d.wrap)(e.slice(-6),h,r),p2c:a,p2s:(0,o.encode)(n)}};t.encrypt=g;let v=async(e,t,r,a,n)=>{(0,c.default)(n);let i=(0,s.p2s)(e,n),o=parseInt(e.slice(13,16),10)>>3,l=m(t,e),u=await y(l,i,a,o,`sha${e.slice(8,11)}`);return(0,d.unwrap)(e.slice(-6),u,r)};t.decrypt=v},25233:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(6113);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.randomFillSync}})},94231:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;let a=r(6113),n=r(26251),i=r(33310),s=r(38322),o=r(84248),d=r(30710),c=r(98400),l=(e,t)=>{if("rsa"!==e.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,n.default)(e,t)},u=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return a.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return a.constants.RSA_PKCS1_PADDING;default:return}},p=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function h(e,t,...r){if((0,o.default)(e))return e;if((0,i.isCryptoKey)(e))return(0,s.checkEncCryptoKey)(e,t,...r),a.KeyObject.from(e);throw TypeError((0,d.default)(e,...c.types))}t.encrypt=(e,t,r)=>{let n=u(e),i=p(e),s=h(t,e,"wrapKey","encrypt");return l(s,e),(0,a.publicEncrypt)({key:s,oaepHash:i,padding:n},r)},t.decrypt=(e,t,r)=>{let n=u(e),i=p(e),s=h(t,e,"unwrapKey","decrypt");return l(s,e),(0,a.privateDecrypt)({key:s,oaepHash:i,padding:n},r)}},47389:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="node:crypto"},50222:(e,t,r)=>{let a;Object.defineProperty(t,"__esModule",{value:!0});let n=r(6113),i=r(73837),s=r(80051),o=r(34640),d=r(25865),c=r(85575);a=n.sign.length>3?(0,i.promisify)(n.sign):n.sign;let l=async(e,t,r)=>{let i=(0,c.default)(e,t,"sign");if(e.startsWith("HS")){let t=n.createHmac((0,o.default)(e),i);return t.update(r),t.digest()}return a((0,s.default)(e),r,(0,d.default)(e,i))};t.default=l},97796:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113).timingSafeEqual;t.default=a},42052:(e,t,r)=>{let a;Object.defineProperty(t,"__esModule",{value:!0});let n=r(6113),i=r(73837),s=r(80051),o=r(25865),d=r(50222),c=r(85575),l=r(18407);a=n.verify.length>4&&l.oneShotCallback?(0,i.promisify)(n.verify):n.verify;let u=async(e,t,r,i)=>{let l=(0,c.default)(e,t,"verify");if(e.startsWith("HS")){let t=await (0,d.default)(e,l,i);try{return n.timingSafeEqual(r,t)}catch{return!1}}let u=(0,s.default)(e),p=(0,o.default)(e,l);try{return await a(u,i,p,r)}catch{return!1}};t.default=u},33310:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCryptoKey=void 0;let a=r(6113),n=r(73837),i=a.webcrypto;t.default=i,t.isCryptoKey=n.types.isCryptoKey?e=>n.types.isCryptoKey(e):e=>!1},58755:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deflate=t.inflate=void 0;let a=r(73837),n=r(59796),i=(0,a.promisify)(n.inflateRaw),s=(0,a.promisify)(n.deflateRaw);t.inflate=e=>i(e),t.deflate=e=>s(e)},51320:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0;let a=r(24094);t.encode=a.encode,t.decode=a.decode},90463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeJwt=void 0;let a=r(51320),n=r(43866),i=r(63143),s=r(64478);t.decodeJwt=function(e){let t,r;if("string"!=typeof e)throw new s.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:o,length:d}=e.split(".");if(5===d)throw new s.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==d)throw new s.JWTInvalid("Invalid JWT");if(!o)throw new s.JWTInvalid("JWTs must contain a payload");try{t=(0,a.decode)(o)}catch{throw new s.JWTInvalid("Failed to base64url decode the payload")}try{r=JSON.parse(n.decoder.decode(t))}catch{throw new s.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,i.default)(r))throw new s.JWTInvalid("Invalid JWT Claims Set");return r}},33860:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeProtectedHeader=void 0;let a=r(51320),n=r(43866),i=r(63143);t.decodeProtectedHeader=function(e){let t;if("string"==typeof e){let r=e.split(".");(3===r.length||5===r.length)&&([t]=r)}else if("object"==typeof e&&e){if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header")}try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(n.decoder.decode((0,a.decode)(t)));if(!(0,i.default)(e))throw Error();return e}catch{throw TypeError("Invalid Token or Protected Header formatting")}}},64478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JWSSignatureVerificationFailed=t.JWKSTimeout=t.JWKSMultipleMatchingKeys=t.JWKSNoMatchingKey=t.JWKSInvalid=t.JWKInvalid=t.JWTInvalid=t.JWSInvalid=t.JWEInvalid=t.JWEDecryptionFailed=t.JOSENotSupported=t.JOSEAlgNotAllowed=t.JWTExpired=t.JWTClaimValidationFailed=t.JOSEError=void 0;class r extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}}t.JOSEError=r;class a extends r{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}}t.JWTClaimValidationFailed=a;class n extends r{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}}t.JWTExpired=n;class i extends r{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}t.JOSEAlgNotAllowed=i;class s extends r{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}t.JOSENotSupported=s;class o extends r{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}t.JWEDecryptionFailed=o;class d extends r{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}t.JWEInvalid=d;class c extends r{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}t.JWSInvalid=c;class l extends r{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}t.JWTInvalid=l;class u extends r{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}}t.JWKInvalid=u;class p extends r{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}}t.JWKSInvalid=p;class h extends r{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}}t.JWKSNoMatchingKey=h;class f extends r{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}t.JWKSMultipleMatchingKeys=f,Symbol.asyncIterator;class y extends r{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}}t.JWKSTimeout=y;class m extends r{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}t.JWSSignatureVerificationFailed=m},96770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(47389);t.default=a.default},84143:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;let a=r(6566);t.ZodIssueCode=a.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),t.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class n extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(a);else if("invalid_return_type"===n.code)a(n.returnTypeError);else if("invalid_arguments"===n.code)a(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,a=0;for(;a<n.path.length;){let r=n.path[a];a===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=n,n.create=e=>new n(e)},59607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMap=t.setErrorMap=t.defaultErrorMap=void 0;let a=function(e){return e&&e.__esModule?e:{default:e}}(r(42845));t.defaultErrorMap=a.default;let n=a.default;t.setErrorMap=function(e){n=e},t.getErrorMap=function(){return n}},37332:(e,t,r)=>{var a=Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},n=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(59607),t),n(r(89317),t),n(r(75645),t),n(r(6566),t),n(r(50699),t),n(r(84143),t)},66267:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(t.errorUtil||(t.errorUtil={}))},89317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.addIssueToContext=t.EMPTY_PATH=t.makeIssue=void 0;let a=r(59607),n=function(e){return e&&e.__esModule?e:{default:e}}(r(42845));t.makeIssue=e=>{let{data:t,path:r,errorMaps:a,issueData:n}=e,i=[...r,...n.path||[]],s={...n,path:i},o="";for(let e of a.filter(e=>!!e).slice().reverse())o=e(s,{data:t,defaultError:o}).message;return{...n,path:i,message:n.message||o}},t.EMPTY_PATH=[],t.addIssueToContext=function(e,r){let i=(0,t.makeIssue)({issueData:r,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,(0,a.getErrorMap)(),n.default].filter(e=>!!e)});e.common.issues.push(i)};class i{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,r){let a=[];for(let n of r){if("aborted"===n.status)return t.INVALID;"dirty"===n.status&&e.dirty(),a.push(n.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,t){let r=[];for(let e of t)r.push({key:await e.key,value:await e.value});return i.mergeObjectSync(e,r)}static mergeObjectSync(e,r){let a={};for(let n of r){let{key:r,value:i}=n;if("aborted"===r.status||"aborted"===i.status)return t.INVALID;"dirty"===r.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"!==r.value&&(void 0!==i.value||n.alwaysSet)&&(a[r.value]=i.value)}return{status:e.value,value:a}}}t.ParseStatus=i,t.INVALID=Object.freeze({status:"aborted"}),t.DIRTY=e=>({status:"dirty",value:e}),t.OK=e=>({status:"valid",value:e}),t.isAborted=e=>"aborted"===e.status,t.isDirty=e=>"dirty"===e.status,t.isValid=e=>"valid"===e.status,t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},75645:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6566:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),a={};for(let e of r)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(r=t.util||(t.util={})),(t.objectUtil||(t.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":if(Array.isArray(e))return t.ZodParsedType.array;if(null===e)return t.ZodParsedType.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return t.ZodParsedType.promise;if("undefined"!=typeof Map&&e instanceof Map)return t.ZodParsedType.map;if("undefined"!=typeof Set&&e instanceof Set)return t.ZodParsedType.set;if("undefined"!=typeof Date&&e instanceof Date)return t.ZodParsedType.date;return t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},87245:(e,t,r)=>{var a=Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},n=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;let i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t}(r(37332));t.z=i,function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)}(r(37332),t),t.default=i},42845:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6566),n=r(84143);t.default=(e,t)=>{let r;switch(e.code){case n.ZodIssueCode.invalid_type:r=e.received===a.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case n.ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,a.util.jsonStringifyReplacer)}`;break;case n.ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${a.util.joinValues(e.keys,", ")}`;break;case n.ZodIssueCode.invalid_union:r="Invalid input";break;case n.ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${a.util.joinValues(e.options)}`;break;case n.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${a.util.joinValues(e.options)}, received '${e.received}'`;break;case n.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case n.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case n.ZodIssueCode.invalid_date:r="Invalid date";break;case n.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:a.util.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case n.ZodIssueCode.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case n.ZodIssueCode.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case n.ZodIssueCode.custom:r="Invalid input";break;case n.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case n.ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case n.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,a.util.assertNever(e)}return{message:r}}},50699:(e,t,r)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.date=t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.custom=t.ZodReadonly=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=t.discriminatedUnion=void 0;let n=r(59607),i=r(66267),s=r(89317),o=r(6566),d=r(84143);class c{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let l=(e,t)=>{if((0,s.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new d.ZodError(e.common.issues);return this._error=t,this._error}}};function u(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:n}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=a?a:t.defaultError}:{message:null!=r?r:t.defaultError},description:n}}class p{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,o.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,o.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new s.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,o.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if((0,s.isAsync)(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;let a={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,o.getParsedType)(e)},n=this._parseSync({data:e,path:a.path,parent:a});return l(a,n)}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,o.getParsedType)(e)},a=this._parse({data:e,path:r.path,parent:r});return l(r,await ((0,s.isAsync)(a)?a:Promise.resolve(a)))}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,a)=>{let n=e(t),i=()=>a.addIssue({code:d.ZodIssueCode.custom,...r(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(i(),!1)):!!n||(i(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new X({schema:this,typeName:a.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Y.create(this,this._def)}nullable(){return Q.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return W.create(this,this._def)}promise(){return q.create(this,this._def)}or(e){return j.create([this,e],this._def)}and(e){return M.create(this,e,this._def)}transform(e){return new X({...u(this._def),schema:this,typeName:a.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ee({...u(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:a.ZodDefault})}brand(){return new ea({typeName:a.ZodBranded,type:this,...u(this._def)})}catch(e){return new et({...u(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:a.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return en.create(this,e)}readonly(){return ei.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=p,t.Schema=p,t.ZodSchema=p;let h=/^c[^\s-]{8,}$/i,f=/^[a-z][a-z0-9]*$/,y=/[0-9A-HJKMNP-TV-Z]{26}/,m=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,g=/^([A-Z0-9_+-]+\.?)*[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,v=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,_=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,w=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,b=e=>e.precision?e.offset?RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}Z$`):0===e.precision?e.offset?RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):e.offset?RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");class E extends p{constructor(){super(...arguments),this._regex=(e,t,r)=>this.refinement(t=>e.test(t),{validation:t,code:d.ZodIssueCode.invalid_string,...i.errorUtil.errToObj(r)}),this.nonempty=e=>this.min(1,i.errorUtil.errToObj(e)),this.trim=()=>new E({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new E({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new E({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){let t;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==o.ZodParsedType.string){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.string,received:t.parsedType}),s.INVALID}let r=new s.ParseStatus;for(let i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if("max"===i.kind)e.data.length>i.value&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if("length"===i.kind){let a=e.data.length>i.value,n=e.data.length<i.value;(a||n)&&(t=this._getOrReturnCtx(e,t),a?(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):n&&(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if("email"===i.kind)g.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"email",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("emoji"===i.kind)v.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"emoji",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("uuid"===i.kind)m.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"uuid",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("cuid"===i.kind)h.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"cuid",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("cuid2"===i.kind)f.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"cuid2",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("ulid"===i.kind)y.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"ulid",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(a){t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"url",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty()}else if("regex"===i.kind)i.regex.lastIndex=0,i.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"regex",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty());else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty());else if("datetime"===i.kind)b(i).test(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_string,validation:"datetime",message:i.message}),r.dirty());else if("ip"===i.kind){var a,n;a=e.data,("v4"===(n=i.version)||!n)&&_.test(a)||("v6"===n||!n)&&w.test(a)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{validation:"ip",code:d.ZodIssueCode.invalid_string,message:i.message}),r.dirty())}else o.util.assertNever(i);return{status:r.value,value:e.data}}_addCheck(e){return new E({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...i.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...i.errorUtil.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...i.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errorUtil.errToObj(t)})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodString=E,E.create=e=>{var t;return new E({checks:[],typeName:a.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...u(e)})};class S extends p{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==o.ZodParsedType.number){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.number,received:t.parsedType}),s.INVALID}let r=new s.ParseStatus;for(let a of this._def.checks)"int"===a.kind?o.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"multipleOf"===a.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a;return parseInt(e.toFixed(n).replace(".",""))%parseInt(t.toFixed(n).replace(".",""))/Math.pow(10,n)}(e.data,a.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.not_finite,message:a.message}),r.dirty()):o.util.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,r,a){return new S({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.errorUtil.toString(a)}]})}_addCheck(e){return new S({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:i.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.errorUtil.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&o.util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=S,S.create=e=>new S({checks:[],typeName:a.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...u(e)});class I extends p{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==o.ZodParsedType.bigint){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.bigint,received:t.parsedType}),s.INVALID}let r=new s.ParseStatus;for(let a of this._def.checks)"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):o.util.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,r,a){return new I({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.errorUtil.toString(a)}]})}_addCheck(e){return new I({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=I,I.create=e=>{var t;return new I({checks:[],typeName:a.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...u(e)})};class P extends p{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==o.ZodParsedType.boolean){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.boolean,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodBoolean=P,P.create=e=>new P({typeName:a.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...u(e)});class T extends p{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==o.ZodParsedType.date){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.date,received:t.parsedType}),s.INVALID}if(isNaN(e.data.getTime())){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_date}),s.INVALID}let r=new s.ParseStatus;for(let a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):o.util.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new T({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.errorUtil.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=T,T.create=e=>new T({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:a.ZodDate,...u(e)});class C extends p{_parse(e){if(this._getType(e)!==o.ZodParsedType.symbol){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.symbol,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodSymbol=C,C.create=e=>new C({typeName:a.ZodSymbol,...u(e)});class k extends p{_parse(e){if(this._getType(e)!==o.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.undefined,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodUndefined=k,k.create=e=>new k({typeName:a.ZodUndefined,...u(e)});class A extends p{_parse(e){if(this._getType(e)!==o.ZodParsedType.null){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.null,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodNull=A,A.create=e=>new A({typeName:a.ZodNull,...u(e)});class O extends p{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,s.OK)(e.data)}}t.ZodAny=O,O.create=e=>new O({typeName:a.ZodAny,...u(e)});class x extends p{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,s.OK)(e.data)}}t.ZodUnknown=x,x.create=e=>new x({typeName:a.ZodUnknown,...u(e)});class J extends p{_parse(e){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.never,received:t.parsedType}),s.INVALID}}t.ZodNever=J,J.create=e=>new J({typeName:a.ZodNever,...u(e)});class K extends p{_parse(e){if(this._getType(e)!==o.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.void,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodVoid=K,K.create=e=>new K({typeName:a.ZodVoid,...u(e)});class W extends p{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==o.ZodParsedType.array)return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.array,received:t.parsedType}),s.INVALID;if(null!==a.exactLength){let e=t.data.length>a.exactLength.value,n=t.data.length<a.exactLength.value;(e||n)&&((0,s.addIssueToContext)(t,{code:e?d.ZodIssueCode.too_big:d.ZodIssueCode.too_small,minimum:n?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&((0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&((0,s.addIssueToContext)(t,{code:d.ZodIssueCode.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new c(t,e,t.path,r)))).then(e=>s.ParseStatus.mergeArray(r,e));let n=[...t.data].map((e,r)=>a.type._parseSync(new c(t,e,t.path,r)));return s.ParseStatus.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new W({...this._def,minLength:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new W({...this._def,maxLength:{value:e,message:i.errorUtil.toString(t)}})}length(e,t){return new W({...this._def,exactLength:{value:e,message:i.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}t.ZodArray=W,W.create=(e,t)=>new W({type:e,minLength:null,maxLength:null,exactLength:null,typeName:a.ZodArray,...u(t)});class Z extends p{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=o.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==o.ZodParsedType.object){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.object,received:t.parsedType}),s.INVALID}let{status:t,ctx:r}=this._processInputParams(e),{shape:a,keys:n}=this._getCached(),i=[];if(!(this._def.catchall instanceof J&&"strip"===this._def.unknownKeys))for(let e in r.data)n.includes(e)||i.push(e);let l=[];for(let e of n){let t=a[e],n=r.data[e];l.push({key:{status:"valid",value:e},value:t._parse(new c(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof J){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of i)l.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)i.length>0&&((0,s.addIssueToContext)(r,{code:d.ZodIssueCode.unrecognized_keys,keys:i}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of i){let a=r.data[t];l.push({key:{status:"valid",value:t},value:e._parse(new c(r,a,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of l){let r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e}).then(e=>s.ParseStatus.mergeObjectSync(t,e)):s.ParseStatus.mergeObjectSync(t,l)}get shape(){return this._def.shape()}strict(e){return i.errorUtil.errToObj,new Z({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var a,n,s,o;let d=null!==(s=null===(n=(a=this._def).errorMap)||void 0===n?void 0:n.call(a,t,r).message)&&void 0!==s?s:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(o=i.errorUtil.errToObj(e).message)&&void 0!==o?o:d}:{message:d}}}:{}})}strip(){return new Z({...this._def,unknownKeys:"strip"})}passthrough(){return new Z({...this._def,unknownKeys:"passthrough"})}extend(e){return new Z({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Z({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:a.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Z({...this._def,catchall:e})}pick(e){let t={};return o.util.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new Z({...this._def,shape:()=>t})}omit(e){let t={};return o.util.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new Z({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof Z){let r={};for(let a in t.shape){let n=t.shape[a];r[a]=Y.create(e(n))}return new Z({...t._def,shape:()=>r})}return t instanceof W?new W({...t._def,type:e(t.element)}):t instanceof Y?Y.create(e(t.unwrap())):t instanceof Q?Q.create(e(t.unwrap())):t instanceof U?U.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};return o.util.objectKeys(this.shape).forEach(r=>{let a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}),new Z({...this._def,shape:()=>t})}required(e){let t={};return o.util.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof Y;)e=e._def.innerType;t[r]=e}}),new Z({...this._def,shape:()=>t})}keyof(){return F(o.util.objectKeys(this.shape))}}t.ZodObject=Z,Z.create=(e,t)=>new Z({shape:()=>e,unknownKeys:"strip",catchall:J.create(),typeName:a.ZodObject,...u(t)}),Z.strictCreate=(e,t)=>new Z({shape:()=>e,unknownKeys:"strict",catchall:J.create(),typeName:a.ZodObject,...u(t)}),Z.lazycreate=(e,t)=>new Z({shape:e,unknownKeys:"strip",catchall:J.create(),typeName:a.ZodObject,...u(t)});class j extends p{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new d.ZodError(e.ctx.common.issues));return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_union,unionErrors:r}),s.INVALID});{let e;let a=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},i=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=a.map(e=>new d.ZodError(e));return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_union,unionErrors:n}),s.INVALID}}get options(){return this._def.options}}t.ZodUnion=j,j.create=(e,t)=>new j({options:e,typeName:a.ZodUnion,...u(t)});let N=e=>{if(e instanceof V)return N(e.schema);if(e instanceof X)return N(e.innerType());if(e instanceof B)return[e.value];if(e instanceof z)return e.options;if(e instanceof G)return Object.keys(e.enum);if(e instanceof ee)return N(e._def.innerType);if(e instanceof k)return[void 0];else if(e instanceof A)return[null];else return null};class H extends p{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==o.ZodParsedType.object)return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.object,received:t.parsedType}),s.INVALID;let r=this.discriminator,a=t.data[r],n=this.optionsMap.get(a);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):((0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),s.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let n=new Map;for(let r of t){let t=N(r.shape[e]);if(!t)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of t){if(n.has(a))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,r)}}return new H({typeName:a.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...u(r)})}}t.ZodDiscriminatedUnion=H;class M extends p{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=(e,a)=>{if((0,s.isAborted)(e)||(0,s.isAborted)(a))return s.INVALID;let n=function e(t,r){let a=(0,o.getParsedType)(t),n=(0,o.getParsedType)(r);if(t===r)return{valid:!0,data:t};if(a===o.ZodParsedType.object&&n===o.ZodParsedType.object){let a=o.util.objectKeys(r),n=o.util.objectKeys(t).filter(e=>-1!==a.indexOf(e)),i={...t,...r};for(let a of n){let n=e(t[a],r[a]);if(!n.valid)return{valid:!1};i[a]=n.data}return{valid:!0,data:i}}if(a===o.ZodParsedType.array&&n===o.ZodParsedType.array){if(t.length!==r.length)return{valid:!1};let a=[];for(let n=0;n<t.length;n++){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1};a.push(i.data)}return{valid:!0,data:a}}return a===o.ZodParsedType.date&&n===o.ZodParsedType.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,a.value);return n.valid?(((0,s.isDirty)(e)||(0,s.isDirty)(a))&&t.dirty(),{status:t.value,value:n.data}):((0,s.addIssueToContext)(r,{code:d.ZodIssueCode.invalid_intersection_types}),s.INVALID)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>a(e,t)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}t.ZodIntersection=M,M.create=(e,t,r)=>new M({left:e,right:t,typeName:a.ZodIntersection,...u(r)});class U extends p{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==o.ZodParsedType.array)return(0,s.addIssueToContext)(r,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.array,received:r.parsedType}),s.INVALID;if(r.data.length<this._def.items.length)return(0,s.addIssueToContext)(r,{code:d.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.INVALID;!this._def.rest&&r.data.length>this._def.items.length&&((0,s.addIssueToContext)(r,{code:d.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let a=[...r.data].map((e,t)=>{let a=this._def.items[t]||this._def.rest;return a?a._parse(new c(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(a).then(e=>s.ParseStatus.mergeArray(t,e)):s.ParseStatus.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new U({...this._def,rest:e})}}t.ZodTuple=U,U.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new U({items:e,typeName:a.ZodTuple,rest:null,...u(t)})};class R extends p{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==o.ZodParsedType.object)return(0,s.addIssueToContext)(r,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.object,received:r.parsedType}),s.INVALID;let a=[],n=this._def.keyType,i=this._def.valueType;for(let e in r.data)a.push({key:n._parse(new c(r,e,r.path,e)),value:i._parse(new c(r,r.data[e],r.path,e))});return r.common.async?s.ParseStatus.mergeObjectAsync(t,a):s.ParseStatus.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new R(t instanceof p?{keyType:e,valueType:t,typeName:a.ZodRecord,...u(r)}:{keyType:E.create(),valueType:e,typeName:a.ZodRecord,...u(t)})}}t.ZodRecord=R;class D extends p{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==o.ZodParsedType.map)return(0,s.addIssueToContext)(r,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.map,received:r.parsedType}),s.INVALID;let a=this._def.keyType,n=this._def.valueType,i=[...r.data.entries()].map(([e,t],i)=>({key:a._parse(new c(r,e,r.path,[i,"key"])),value:n._parse(new c(r,t,r.path,[i,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of i){let a=await r.key,n=await r.value;if("aborted"===a.status||"aborted"===n.status)return s.INVALID;("dirty"===a.status||"dirty"===n.status)&&t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of i){let a=r.key,n=r.value;if("aborted"===a.status||"aborted"===n.status)return s.INVALID;("dirty"===a.status||"dirty"===n.status)&&t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}}}}t.ZodMap=D,D.create=(e,t,r)=>new D({valueType:t,keyType:e,typeName:a.ZodMap,...u(r)});class L extends p{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==o.ZodParsedType.set)return(0,s.addIssueToContext)(r,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.set,received:r.parsedType}),s.INVALID;let a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&((0,s.addIssueToContext)(r,{code:d.ZodIssueCode.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&((0,s.addIssueToContext)(r,{code:d.ZodIssueCode.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());let n=this._def.valueType;function i(e){let r=new Set;for(let a of e){if("aborted"===a.status)return s.INVALID;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}let l=[...r.data.values()].map((e,t)=>n._parse(new c(r,e,r.path,t)));return r.common.async?Promise.all(l).then(e=>i(e)):i(l)}min(e,t){return new L({...this._def,minSize:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new L({...this._def,maxSize:{value:e,message:i.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=L,L.create=(e,t)=>new L({valueType:e,minSize:null,maxSize:null,typeName:a.ZodSet,...u(t)});class $ extends p{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==o.ZodParsedType.function)return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.function,received:t.parsedType}),s.INVALID;function r(e,r){return(0,s.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(e=>!!e),issueData:{code:d.ZodIssueCode.invalid_arguments,argumentsError:r}})}function a(e,r){return(0,s.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(e=>!!e),issueData:{code:d.ZodIssueCode.invalid_return_type,returnTypeError:r}})}let i={errorMap:t.common.contextualErrorMap},c=t.data;if(this._def.returns instanceof q){let e=this;return(0,s.OK)(async function(...t){let n=new d.ZodError([]),s=await e._def.args.parseAsync(t,i).catch(e=>{throw n.addIssue(r(t,e)),n}),o=await Reflect.apply(c,this,s);return await e._def.returns._def.type.parseAsync(o,i).catch(e=>{throw n.addIssue(a(o,e)),n})})}{let e=this;return(0,s.OK)(function(...t){let n=e._def.args.safeParse(t,i);if(!n.success)throw new d.ZodError([r(t,n.error)]);let s=Reflect.apply(c,this,n.data),o=e._def.returns.safeParse(s,i);if(!o.success)throw new d.ZodError([a(s,o.error)]);return o.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new $({...this._def,args:U.create(e).rest(x.create())})}returns(e){return new $({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new $({args:e||U.create([]).rest(x.create()),returns:t||x.create(),typeName:a.ZodFunction,...u(r)})}}t.ZodFunction=$;class V extends p{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=V,V.create=(e,t)=>new V({getter:e,typeName:a.ZodLazy,...u(t)});class B extends p{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{received:t.data,code:d.ZodIssueCode.invalid_literal,expected:this._def.value}),s.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function F(e,t){return new z({values:e,typeName:a.ZodEnum,...u(t)})}t.ZodLiteral=B,B.create=(e,t)=>new B({value:e,typeName:a.ZodLiteral,...u(t)});class z extends p{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,s.addIssueToContext)(t,{expected:o.util.joinValues(r),received:t.parsedType,code:d.ZodIssueCode.invalid_type}),s.INVALID}if(-1===this._def.values.indexOf(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,s.addIssueToContext)(t,{received:t.data,code:d.ZodIssueCode.invalid_enum_value,options:r}),s.INVALID}return(0,s.OK)(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e){return z.create(e)}exclude(e){return z.create(this.options.filter(t=>!e.includes(t)))}}t.ZodEnum=z,z.create=F;class G extends p{_parse(e){let t=o.util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==o.ZodParsedType.string&&r.parsedType!==o.ZodParsedType.number){let e=o.util.objectValues(t);return(0,s.addIssueToContext)(r,{expected:o.util.joinValues(e),received:r.parsedType,code:d.ZodIssueCode.invalid_type}),s.INVALID}if(-1===t.indexOf(e.data)){let e=o.util.objectValues(t);return(0,s.addIssueToContext)(r,{received:r.data,code:d.ZodIssueCode.invalid_enum_value,options:e}),s.INVALID}return(0,s.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=G,G.create=(e,t)=>new G({values:e,typeName:a.ZodNativeEnum,...u(t)});class q extends p{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==o.ZodParsedType.promise&&!1===t.common.async)return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.promise,received:t.parsedType}),s.INVALID;let r=t.parsedType===o.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,s.OK)(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}t.ZodPromise=q,q.create=(e,t)=>new q({type:e,typeName:a.ZodPromise,...u(t)});class X extends p{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===a.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,n={addIssue:e=>{(0,s.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===a.type){let e=a.transform(r.data,n);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then(e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r})):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===a.type){let e=e=>{let t=a.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?s.INVALID:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?s.INVALID:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}}if("transform"===a.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>(0,s.isValid)(e)?Promise.resolve(a.transform(e.value,n)).then(e=>({status:t.value,value:e})):e);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,s.isValid)(e))return e;let i=a.transform(e.value,n);if(i instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}}o.util.assertNever(a)}}t.ZodEffects=X,t.ZodTransformer=X,X.create=(e,t,r)=>new X({schema:e,typeName:a.ZodEffects,effect:t,...u(r)}),X.createWithPreprocess=(e,t,r)=>new X({schema:t,effect:{type:"preprocess",transform:e},typeName:a.ZodEffects,...u(r)});class Y extends p{_parse(e){return this._getType(e)===o.ZodParsedType.undefined?(0,s.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=Y,Y.create=(e,t)=>new Y({innerType:e,typeName:a.ZodOptional,...u(t)});class Q extends p{_parse(e){return this._getType(e)===o.ZodParsedType.null?(0,s.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=Q,Q.create=(e,t)=>new Q({innerType:e,typeName:a.ZodNullable,...u(t)});class ee extends p{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===o.ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=ee,ee.create=(e,t)=>new ee({innerType:e,typeName:a.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...u(t)});class et extends p{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return(0,s.isAsync)(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new d.ZodError(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new d.ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=et,et.create=(e,t)=>new et({innerType:e,typeName:a.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...u(t)});class er extends p{_parse(e){if(this._getType(e)!==o.ZodParsedType.nan){let t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:d.ZodIssueCode.invalid_type,expected:o.ZodParsedType.nan,received:t.parsedType}),s.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=er,er.create=e=>new er({typeName:a.ZodNaN,...u(e)}),t.BRAND=Symbol("zod_brand");class ea extends p{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ea;class en extends p{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?s.INVALID:"dirty"===e.status?(t.dirty(),(0,s.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?s.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new en({in:e,out:t,typeName:a.ZodPipeline})}}t.ZodPipeline=en;class ei extends p{_parse(e){let t=this._def.innerType._parse(e);return(0,s.isValid)(t)&&(t.value=Object.freeze(t.value)),t}}t.ZodReadonly=ei,ei.create=(e,t)=>new ei({innerType:e,typeName:a.ZodReadonly,...u(t)}),t.custom=(e,t={},r)=>e?O.create().superRefine((a,n)=>{var i,s;if(!e(a)){let e="function"==typeof t?t(a):"string"==typeof t?{message:t}:t,o=null===(s=null!==(i=e.fatal)&&void 0!==i?i:r)||void 0===s||s;n.addIssue({code:"custom",..."string"==typeof e?{message:e}:e,fatal:o})}}):O.create(),t.late={object:Z.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(a=t.ZodFirstPartyTypeKind||(t.ZodFirstPartyTypeKind={})),t.instanceof=(e,r={message:`Input not instance of ${e.name}`})=>(0,t.custom)(t=>t instanceof e,r);let es=E.create;t.string=es;let eo=S.create;t.number=eo;let ed=er.create;t.nan=ed;let ec=I.create;t.bigint=ec;let el=P.create;t.boolean=el;let eu=T.create;t.date=eu;let ep=C.create;t.symbol=ep;let eh=k.create;t.undefined=eh;let ef=A.create;t.null=ef;let ey=O.create;t.any=ey;let em=x.create;t.unknown=em;let eg=J.create;t.never=eg;let ev=K.create;t.void=ev;let e_=W.create;t.array=e_;let ew=Z.create;t.object=ew;let eb=Z.strictCreate;t.strictObject=eb;let eE=j.create;t.union=eE;let eS=H.create;t.discriminatedUnion=eS;let eI=M.create;t.intersection=eI;let eP=U.create;t.tuple=eP;let eT=R.create;t.record=eT;let eC=D.create;t.map=eC;let ek=L.create;t.set=ek;let eA=$.create;t.function=eA;let eO=V.create;t.lazy=eO;let ex=B.create;t.literal=ex;let eJ=z.create;t.enum=eJ;let eK=G.create;t.nativeEnum=eK;let eW=q.create;t.promise=eW;let eZ=X.create;t.effect=eZ,t.transformer=eZ;let ej=Y.create;t.optional=ej;let eN=Q.create;t.nullable=eN;let eH=X.createWithPreprocess;t.preprocess=eH;let eM=en.create;t.pipeline=eM,t.ostring=()=>es().optional(),t.onumber=()=>eo().optional(),t.oboolean=()=>el().optional(),t.coerce={string:e=>E.create({...e,coerce:!0}),number:e=>S.create({...e,coerce:!0}),boolean:e=>P.create({...e,coerce:!0}),bigint:e=>I.create({...e,coerce:!0}),date:e=>T.create({...e,coerce:!0})},t.NEVER=s.INVALID}};